{
  "root": {
    "id": "root",
    "name": "root",
    "displayName": "Root",
    "type": "directory",
    "path": "",
    "urlPath": "/",
    "include": true,
    "children": [
      {
        "id": "readme",
        "name": "readme",
        "displayName": "README",
        "type": "file",
        "order": 1,
        "path": "readme",
        "urlPath": "/readme",
        "content": "<!-- component-READMEComponent -->\n",
        "components": [
          {
            "id": "component-READMEComponent",
            "name": "READMEComponent",
            "displayName": "READMEComponent",
            "type": "component",
            "path": "readme.component.READMEComponent",
            "urlPath": "",
            "componentId": "READMEComponent",
            "include": true
          }
        ],
        "sections": {},
        "include": true,
        "includeInSidebar": true,
        "isDynamicRobotsFile": false
      },
      {
        "id": "theme",
        "name": "theme",
        "displayName": "Theme",
        "type": "file",
        "order": 2,
        "path": "theme",
        "urlPath": "/theme",
        "content": "# Theme configuration\n\nSelect and customize your theme! These styles will be applied to every component in your generated web app.\n\n<!-- component-ThemeConfiguration -->\n",
        "components": [
          {
            "id": "component-ThemeConfiguration",
            "name": "ThemeConfiguration",
            "displayName": "ThemeConfiguration",
            "type": "component",
            "path": "theme.component.ThemeConfiguration",
            "urlPath": "",
            "componentId": "ThemeConfiguration",
            "include": true
          }
        ],
        "sections": {},
        "include": true,
        "includeInSidebar": true,
        "isDynamicRobotsFile": false
      },
      {
        "id": "app-directory",
        "name": "app-directory",
        "displayName": "App Directory",
        "type": "file",
        "order": 3,
        "path": "app-directory",
        "urlPath": "/app-directory",
        "content": "# App Directory\n\nThe app directory provides a site map, a UI layout heirarchy, and a data management strategy.\n\n<!-- component-LayoutAndStructure -->\n",
        "components": [
          {
            "id": "component-LayoutAndStructure",
            "name": "LayoutAndStructure",
            "displayName": "LayoutAndStructure",
            "type": "component",
            "path": "app-directory.component.LayoutAndStructure",
            "urlPath": "",
            "componentId": "LayoutAndStructure",
            "include": true
          }
        ],
        "sections": {},
        "include": true,
        "includeInSidebar": true,
        "isDynamicRobotsFile": false
      },
      {
        "id": "database",
        "name": "database",
        "displayName": "Database",
        "type": "file",
        "order": 4,
        "path": "database",
        "urlPath": "/database",
        "content": "# Database\n\n<!-- component-DatabaseConfiguration -->\n",
        "components": [
          {
            "id": "component-DatabaseConfiguration",
            "name": "DatabaseConfiguration",
            "displayName": "DatabaseConfiguration",
            "type": "component",
            "path": "database.component.DatabaseConfiguration",
            "urlPath": "",
            "componentId": "DatabaseConfiguration",
            "include": true
          }
        ],
        "sections": {},
        "include": true,
        "includeInSidebar": true,
        "isDynamicRobotsFile": false
      },
      {
        "id": "environment",
        "name": "environment",
        "displayName": "Environment",
        "type": "file",
        "order": 5,
        "path": "environment",
        "urlPath": "/environment",
        "content": "# Environment\n\n<!-- component-NextStepsComponent -->\n",
        "components": [
          {
            "id": "component-NextStepsComponent",
            "name": "NextStepsComponent",
            "displayName": "NextStepsComponent",
            "type": "component",
            "path": "environment.component.NextStepsComponent",
            "urlPath": "",
            "componentId": "NextStepsComponent",
            "include": true
          }
        ],
        "sections": {},
        "include": true,
        "includeInSidebar": true,
        "isDynamicRobotsFile": false
      },
      {
        "id": "extensions",
        "name": "extensions",
        "displayName": "Extensions",
        "type": "file",
        "order": 6,
        "path": "extensions",
        "urlPath": "/extensions",
        "content": "# Extensions\n\n<!-- component-ExtensionsComponent -->\n",
        "components": [
          {
            "id": "component-ExtensionsComponent",
            "name": "ExtensionsComponent",
            "displayName": "ExtensionsComponent",
            "type": "component",
            "path": "extensions.component.ExtensionsComponent",
            "urlPath": "",
            "componentId": "ExtensionsComponent",
            "include": true
          }
        ],
        "sections": {},
        "include": true,
        "includeInSidebar": true,
        "isDynamicRobotsFile": false
      },
      {
        "id": "10-util",
        "name": "10-util",
        "displayName": " 10-util",
        "type": "file",
        "path": "10-util",
        "urlPath": "/10-util",
        "content": "# File examples\n\nThis guide provides code examples and patterns for organizing your application code following best practices.\n\n## Types file example\n\nType definitions establish contracts and ensure type safety throughout your application.\n\n<!-- section-1 -->\n\n## Stores file example\n\nZustand stores manage application state with persistence and middleware support.\n\n<!-- section-2 -->\n\n## Actions file example\n\nServer actions handle data mutations and communicate with your backend services.\n\n<!-- section-3 -->\n\n## Hooks file example\n\nReact Query hooks manage data fetching, caching, and synchronization.\n\n<!-- section-4 -->\n\n## Utility files\n\nUtility modules provide reusable helper functions and configurations.\n\n<!-- section-5 -->\n",
        "components": [],
        "sections": {
          "section1": {
            "option1": {
              "content": "**Types file example (Client-side):**\n\n```typescript\nexport interface AppState {\n  data: any[];\n  setData: (data: any[]) => void;\n  isLoading: boolean;\n  setIsLoading: (isLoading: boolean) => void;\n  reset: () => void;\n}\n\nexport interface ApiData {\n  id: string;\n  name: string;\n  value: number;\n}\n```",
              "include": true
            },
            "option2": {
              "content": "**Types file example (With Database):**\n\n```typescript\nimport { User } from \"@prisma/client\";\n\nexport interface AppState {\n  user: User | null;\n  setUser: (user: User | null) => void;\n  tempEmail?: string;\n  setTempEmail: (tempEmail: string) => void;\n  reset: () => void;\n}\n\nexport interface SignInData {\n  email: string;\n  password: string;\n}\n```",
              "include": true
            }
          },
          "section2": {
            "option1": {
              "content": "### Store Example (With Database)\n\n```typescript\nimport { UserRole } from \"@prisma/client\";\nimport { create } from \"zustand\";\nimport { persist } from \"zustand/middleware\";\nimport { AppState, ExtendedUser, RedirectState } from \"./layout.types\";\n\nconst initialState = {\n  user: null,\n};\n\nexport const useAppStore = create<AppState>()((set) => ({\n  ...initialState,\n  setUser: (user) => set({ user, profile: user?.profile || null }),\n  reset: () => set(initialState),\n}));\n```\n\n**Usage with React Query:**\n```typescript\nimport { useAppStore } from \"@/stores/app.stores\";\nimport { useGetUser } from \"@/hooks/user.hooks\";\n\nexport const UserProfile = () => {\n  const setUser = useAppStore((state) => state.setUser);\n  const user = useAppStore((state) => state.user);\n\n  const { isLoading } = useGetUser({\n    onSuccess: (data) => setUser(data),\n  });\n\n  if (isLoading) return <div>Loading...</div>;\n\n  return <div>Welcome, {user?.name}</div>;\n};\n```",
              "include": true
            },
            "option2": {
              "content": "### Store Example (Without Database)\n\n```typescript\nimport { create } from \"zustand\";\nimport { persist } from \"zustand/middleware\";\n\ninterface AppState {\n  theme: \"light\" | \"dark\";\n  setTheme: (theme: \"light\" | \"dark\") => void;\n  sidebarOpen: boolean;\n  toggleSidebar: () => void;\n}\n\nexport const useAppStore = create<AppState>()(\n  persist(\n    (set) => ({\n      theme: \"light\",\n      setTheme: (theme) => set({ theme }),\n      sidebarOpen: true,\n      toggleSidebar: () => set((state) => ({ sidebarOpen: !state.sidebarOpen })),\n    }),\n    {\n      name: \"app-storage\",\n    }\n  )\n);\n```\n\n**Usage:**\n```typescript\nimport { useAppStore } from \"@/stores/app.stores\";\n\nexport const ThemeToggle = () => {\n  const { theme, setTheme } = useAppStore();\n\n  return (\n    <button onClick={() => setTheme(theme === \"light\" ? \"dark\" : \"light\")}>\n      Toggle Theme\n    </button>\n  );\n};\n```",
              "include": true
            }
          },
          "section3": {
            "option1": {
              "content": "**No actions file needed for client-side only applications.**\n\nUse API routes or external API calls directly in hooks with React Query.",
              "include": true
            },
            "option2": {
              "content": "**Actions file example (NeonDB + Better Auth):**\n\n```typescript\n\"use server\";\n\nimport { ActionResponse, getActionResponse } from \"@/lib/action.utils\";\nimport { auth } from \"@/lib/auth\";\nimport { getAuthenticatedClient } from \"@/lib/auth.utils\";\nimport { User } from \"@prisma/client\";\nimport { headers } from \"next/headers\";\n\nexport const getUserAction = async (): Promise<ActionResponse<User | null>> => {\n  try {\n    const session = await auth.api.getSession({\n      headers: await headers(),\n    });\n\n    if (!session?.user) return getActionResponse();\n\n    const { db } = await getAuthenticatedClient();\n\n    const prismaUser = await db.user.findUnique({\n      where: { id: session.user.id },\n    });\n\n    return getActionResponse({ data: prismaUser });\n  } catch (error) {\n    return getActionResponse({ error });\n  }\n};\n```",
              "include": true
            },
            "option3": {
              "content": "**Actions file example (Supabase + Better Auth):**\n\n```typescript\n\"use server\";\n\nimport { ActionResponse, getActionResponse } from \"@/lib/action.utils\";\nimport { auth } from \"@/lib/auth\";\nimport { getAuthenticatedClient } from \"@/lib/auth.utils\";\nimport { User } from \"@prisma/client\";\nimport { headers } from \"next/headers\";\n\nexport const getUserAction = async (): Promise<ActionResponse<User | null>> => {\n  try {\n    const session = await auth.api.getSession({\n      headers: await headers(),\n    });\n\n    if (!session?.user) return getActionResponse();\n\n    const { db } = await getAuthenticatedClient();\n\n    const prismaUser = await db.user.findUnique({\n      where: { id: session.user.id },\n    });\n\n    return getActionResponse({ data: prismaUser });\n  } catch (error) {\n    return getActionResponse({ error });\n  }\n};\n```",
              "include": true
            },
            "option4": {
              "content": "**Actions file example (Supabase Auth Only):**\n\n```typescript\n\"use server\";\n\nimport { createClient } from \"@/lib/supabase/server\";\nimport { ActionResponse, getActionResponse } from \"@/lib/action.utils\";\n\nexport const getUserAction = async (): Promise<ActionResponse<any>> => {\n  try {\n    const supabase = await createClient();\n\n    const { data: { user }, error: authError } = await supabase.auth.getUser();\n\n    if (authError || !user) {\n      return getActionResponse({ error: authError?.message || \"Not authenticated\" });\n    }\n\n    const { data, error } = await supabase\n      .from('users')\n      .select('*')\n      .eq('id', user.id)\n      .single();\n\n    if (error) throw error;\n\n    return getActionResponse({ data });\n  } catch (error) {\n    return getActionResponse({ error });\n  }\n};\n```",
              "include": true
            }
          },
          "section4": {
            "option1": {
              "content": "**Hooks file example (Client-side):**\n\n```typescript\n\"use client\";\n\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { useRouter } from \"next/navigation\";\nimport { useAppStore } from \"../layout.stores\";\n\nexport const useGetData = () => {\n  const { setData } = useAppStore();\n\n  return useQuery({\n    queryKey: [\"data\"],\n    queryFn: async () => {\n      const response = await fetch(\"/api/data\");\n      if (!response.ok) throw new Error(\"Failed to fetch\");\n      const data = await response.json();\n      setData(data);\n      return data;\n    },\n    staleTime: 1000 * 60 * 5,\n  });\n};\n\nexport const useCreateData = () => {\n  const router = useRouter();\n\n  return useMutation({\n    mutationFn: async (newData: any) => {\n      const response = await fetch(\"/api/data\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify(newData),\n      });\n      if (!response.ok) throw new Error(\"Failed to create\");\n      return response.json();\n    },\n    onSuccess: () => {\n      router.refresh();\n    },\n  });\n};\n```",
              "include": true
            },
            "option2": {
              "content": "**Hooks file example (Better Auth):**\n\n```typescript\n\"use client\";\n\nimport { configuration, privatePaths } from \"@/configuration\";\nimport { signIn } from \"@/lib/auth-client\";\nimport { useMutation, useQuery } from \"@tanstack/react-query\";\nimport { usePathname, useRouter } from \"next/navigation\";\nimport { toast } from \"sonner\";\nimport { Toast } from \"../(components)/Toast\";\nimport { CypressDataAttributes } from \"../../types/cypress.types\";\nimport { useAppStore, useRedirectStore } from \"../layout.stores\";\nimport { SignInData } from \"../layout.types\";\nimport { getUserAction } from \"./layout.actions\";\nimport { useAuthLayoutStore } from \"./layout.stores\";\n\nexport const useGetUser = () => {\n  const { setUser, reset } = useAppStore();\n  const { reset: resetAuthLayout } = useAuthLayoutStore();\n  const { setUserData } = useRedirectStore();\n  const pathname = usePathname();\n\n  const router = useRouter();\n  return useQuery({\n    queryKey: [\"user\"],\n    queryFn: async () => {\n      const { data, error } = await getUserAction();\n      if (!data || error) {\n        if (privatePaths.includes(pathname)) {\n          router.push(configuration.paths.signIn);\n        }\n        reset();\n        resetAuthLayout();\n      }\n      if (error) throw error;\n      setUser(data ?? null);\n\n      setUserData(data);\n\n      return data;\n    },\n    staleTime: 1000 * 60 * 5,\n  });\n};\n\nexport const useSignIn = () => {\n  const { setUser, setTempEmail } = useAppStore();\n  const { setUserData } = useRedirectStore();\n  const router = useRouter();\n\n  return useMutation({\n    mutationFn: async (signInData: SignInData) => {\n      const { error } = await signIn.email({\n        email: signInData.email,\n        password: signInData.password,\n      });\n\n      if (error?.status === 403) setTempEmail(signInData.email);\n\n      if (error) throw error;\n      const { data: userData, error: userError } = await getUserAction();\n\n      if (userError) throw new Error(userError);\n\n      return userData;\n    },\n    onSuccess: (data) => {\n      if (data) {\n        setUser(data);\n        setUserData(data);\n      }\n      toast.custom(() => (\n        <Toast\n          variant=\"success\"\n          title=\"Success\"\n          message=\"Successfully signed in\"\n          data-cy={CypressDataAttributes.TOAST_SUCCESS}\n        />\n      ));\n      if (data && !data.profile?.isOnboardingComplete) {\n        router.push(configuration.paths.onboarding);\n        return;\n      }\n      router.push(configuration.paths.home);\n    },\n    onError: (\n      error: {\n        code?: string | undefined;\n        message?: string | undefined;\n        status: number;\n        statusText: string;\n      } | null\n    ) => {\n      if (error?.status === 403) return;\n      toast.custom(() => (\n        <Toast\n          variant=\"error\"\n          title=\"Sign In Failed\"\n          message={error?.message || \"Failed to sign in\"}\n          data-cy={CypressDataAttributes.TOAST_ERROR}\n        />\n      ));\n    },\n  });\n};\n```",
              "include": true
            },
            "option3": {
              "content": "**Hooks file example (Supabase Auth):**\n\n```typescript\n\"use client\";\n\nimport { createClient } from \"@/lib/supabase/client\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { useRouter } from \"next/navigation\";\nimport { useAppStore } from \"../layout.stores\";\n\nexport const useGetUser = () => {\n  const { setUser, reset } = useAppStore();\n  const router = useRouter();\n\n  return useQuery({\n    queryKey: [\"user\"],\n    queryFn: async () => {\n      const supabase = createClient();\n      const { data: { user }, error: authError } = await supabase.auth.getUser();\n\n      if (authError || !user) {\n        reset();\n        return null;\n      }\n\n      const { data, error } = await supabase\n        .from('users')\n        .select('*')\n        .eq('id', user.id)\n        .single();\n\n      if (error) throw error;\n\n      setUser(data);\n      return data;\n    },\n    staleTime: 1000 * 60 * 5,\n  });\n};\n\nexport const useSignIn = () => {\n  const { setUser } = useAppStore();\n  const router = useRouter();\n\n  return useMutation({\n    mutationFn: async ({ email, password }: { email: string; password: string }) => {\n      const supabase = createClient();\n      const { data, error } = await supabase.auth.signInWithPassword({\n        email,\n        password,\n      });\n\n      if (error) throw error;\n\n      return data.user;\n    },\n    onSuccess: (user) => {\n      setUser(user);\n      router.push('/dashboard');\n    },\n  });\n};\n```",
              "include": true
            }
          },
          "section5": {
            "option1": {
              "content": "**No utility files needed for client-side only applications.**",
              "include": true
            },
            "option2": {
              "content": "**Utility files (Better Auth + Prisma):**\n\n## `prisma-rls.ts`:\n\n```typescript\nimport { Prisma } from \"@prisma/client\";\nimport { prisma } from \"./prisma\";\n\nfunction forUser(userId: string, tenantId?: string) {\n  return Prisma.defineExtension((prisma) =>\n    prisma.$extends({\n      query: {\n        $allModels: {\n          async $allOperations({ args, query }) {\n            if (tenantId) {\n              const [, , result] = await prisma.$transaction([\n                prisma.$executeRaw`SELECT set_config('app.current_user_id', ${userId}, TRUE)`,\n                prisma.$executeRaw`SELECT set_config('app.current_tenant_id', ${tenantId}, TRUE)`,\n                query(args),\n              ]);\n              return result;\n            } else {\n              const [, result] = await prisma.$transaction([\n                prisma.$executeRaw`SELECT set_config('app.current_user_id', ${userId}, TRUE)`,\n                query(args),\n              ]);\n              return result;\n            }\n          },\n        },\n      },\n    })\n  );\n}\n\nexport function createRLSClient(userId: string, tenantId?: string) {\n  return prisma.$extends(forUser(userId, tenantId));\n}\n```\n\n## `auth.util.ts`\n\n```typescript\nimport { User } from \"better-auth\";\nimport jwt from \"jsonwebtoken\";\nimport { headers } from \"next/headers\";\nimport { auth, Session } from \"./auth\";\nimport { createRLSClient } from \"./prisma-rls\";\n\nexport async function getAuthenticatedClient(user?: User): Promise<{\n  db: ReturnType<typeof createRLSClient>;\n  session: Session | null;\n}> {\n  const headersList = await headers();\n\n  const session = await auth.api.getSession({\n    headers: headersList,\n  });\n\n  const userId = user?.id || session?.user.id;\n\n  if (!userId) {\n    throw new Error(\"Unauthorized\");\n  }\n\n  const db = createRLSClient(userId);\n\n  return { db, session };\n}\n\nexport function generateSupabaseJWT(userId: string, userRole: string): string {\n  const jwtSecret = process.env.SUPABASE_JWT_SECRET;\n\n  if (!jwtSecret) {\n    throw new Error(\"SUPABASE_JWT_SECRET is required for JWT generation\");\n  }\n\n  const payload = {\n    aud: \"authenticated\",\n    exp: Math.floor(Date.now() / 1000) + 60 * 60,\n    sub: userId,\n    email: `${userId}@better-auth.local`,\n    role: \"authenticated\",\n    user_metadata: {\n      better_auth_user_id: userId,\n      better_auth_role: userRole,\n    },\n    app_metadata: {\n      provider: \"better-auth\",\n      providers: [\"better-auth\"],\n    },\n  };\n\n  return jwt.sign(payload, jwtSecret, {\n    algorithm: \"HS256\",\n  });\n}\n```\n\n## `log.util.ts`:\n\n```typescript\nexport enum LOG_LABELS {\n  GENERATE = \"generate\",\n  API = \"api\",\n  AUTH = \"auth\",\n  DB = \"db\",\n  FETCH = \"fetch\",\n  RATE_LIMIT = \"rate-limit\",\n  IMAGE = \"image\",\n  WIDGET = \"widget\",\n}\n\ninterface ConditionalLogOptions {\n  maxStringLength?: number;\n  label: LOG_LABELS | string;\n}\n\nexport function conditionalLog(\n  data: unknown,\n  options: ConditionalLogOptions\n): string | null {\n  const { maxStringLength = 200, label } = options;\n\n  const logLabels = process.env.NEXT_PUBLIC_LOG_LABELS;\n\n  if (!logLabels || logLabels === \"none\") {\n    return null;\n  }\n\n  if (logLabels !== \"all\") {\n    const allowedLabels = logLabels.split(\",\").map((l) => l.trim());\n    if (!allowedLabels.includes(label)) {\n      return null;\n    }\n  }\n\n  try {\n    const processedData = deepStringify(data, maxStringLength, new WeakSet());\n    const result = JSON.stringify(processedData);\n    return result.replace(/\\\\s+/g, \"\");\n  } catch (error) {\n    return JSON.stringify({ error: \"Failed to stringify data\", label });\n  }\n}\n\nfunction deepStringify(\n  value: unknown,\n  maxLength: number,\n  seen: WeakSet<object>\n): unknown {\n  if (value === null || value === undefined) {\n    return value;\n  }\n\n  if (typeof value === \"string\") {\n    return truncateString(value, maxLength);\n  }\n\n  if (typeof value === \"number\" || typeof value === \"boolean\") {\n    return value;\n  }\n\n  if (value instanceof Date) {\n    return value.toISOString();\n  }\n\n  if (value instanceof Error) {\n    return {\n      name: value.name,\n      message: truncateString(value.message, maxLength),\n      stack: value.stack ? truncateString(value.stack, maxLength) : undefined,\n    };\n  }\n\n  if (typeof value === \"object\") {\n    if (seen.has(value)) {\n      return \"[Circular Reference]\";\n    }\n\n    seen.add(value);\n\n    if (Array.isArray(value)) {\n      const result = value.map((item) => deepStringify(item, maxLength, seen));\n      seen.delete(value);\n      return result;\n    }\n\n    const result: Record<string, unknown> = {};\n    for (const [key, val] of Object.entries(value)) {\n      result[key] = deepStringify(val, maxLength, seen);\n    }\n    seen.delete(value);\n    return result;\n  }\n\n  return String(value);\n}\n\nfunction truncateString(str: string, maxLength: number): string {\n  if (str.length <= maxLength) {\n    return str;\n  }\n\n  const startLength = Math.floor((maxLength - 3) / 2);\n  const endLength = maxLength - 3 - startLength;\n\n  return str.slice(0, startLength) + \"...\" + str.slice(-endLength);\n}\n```",
              "include": true
            },
            "option3": {
              "content": "**Utility files (Supabase):**\n\n## `log.util.ts`:\n\n```typescript\nexport enum LOG_LABELS {\n  GENERATE = \"generate\",\n  API = \"api\",\n  AUTH = \"auth\",\n  DB = \"db\",\n  FETCH = \"fetch\",\n  RATE_LIMIT = \"rate-limit\",\n  IMAGE = \"image\",\n  WIDGET = \"widget\",\n}\n\ninterface ConditionalLogOptions {\n  maxStringLength?: number;\n  label: LOG_LABELS | string;\n}\n\nexport function conditionalLog(\n  data: unknown,\n  options: ConditionalLogOptions\n): string | null {\n  const { maxStringLength = 200, label } = options;\n\n  const logLabels = process.env.NEXT_PUBLIC_LOG_LABELS;\n\n  if (!logLabels || logLabels === \"none\") {\n    return null;\n  }\n\n  if (logLabels !== \"all\") {\n    const allowedLabels = logLabels.split(\",\").map((l) => l.trim());\n    if (!allowedLabels.includes(label)) {\n      return null;\n    }\n  }\n\n  try {\n    const processedData = deepStringify(data, maxStringLength, new WeakSet());\n    const result = JSON.stringify(processedData);\n    return result.replace(/\\\\s+/g, \"\");\n  } catch (error) {\n    return JSON.stringify({ error: \"Failed to stringify data\", label });\n  }\n}\n\nfunction deepStringify(\n  value: unknown,\n  maxLength: number,\n  seen: WeakSet<object>\n): unknown {\n  if (value === null || value === undefined) {\n    return value;\n  }\n\n  if (typeof value === \"string\") {\n    return truncateString(value, maxLength);\n  }\n\n  if (typeof value === \"number\" || typeof value === \"boolean\") {\n    return value;\n  }\n\n  if (value instanceof Date) {\n    return value.toISOString();\n  }\n\n  if (value instanceof Error) {\n    return {\n      name: value.name,\n      message: truncateString(value.message, maxLength),\n      stack: value.stack ? truncateString(value.stack, maxLength) : undefined,\n    };\n  }\n\n  if (typeof value === \"object\") {\n    if (seen.has(value)) {\n      return \"[Circular Reference]\";\n    }\n\n    seen.add(value);\n\n    if (Array.isArray(value)) {\n      const result = value.map((item) => deepStringify(item, maxLength, seen));\n      seen.delete(value);\n      return result;\n    }\n\n    const result: Record<string, unknown> = {};\n    for (const [key, val] of Object.entries(value)) {\n      result[key] = deepStringify(val, maxLength, seen);\n    }\n    seen.delete(value);\n    return result;\n  }\n\n  return String(value);\n}\n\nfunction truncateString(str: string, maxLength: number): string {\n  if (str.length <= maxLength) {\n    return str;\n  }\n\n  const startLength = Math.floor((maxLength - 3) / 2);\n  const endLength = maxLength - 3 - startLength;\n\n  return str.slice(0, startLength) + \"...\" + str.slice(-endLength);\n}\n```",
              "include": true
            }
          }
        },
        "include": true,
        "includeInSidebar": false,
        "isDynamicRobotsFile": false
      },
      {
        "id": "6-robots",
        "name": "6-robots",
        "displayName": " 6-ROBOTS",
        "type": "file",
        "path": "6-robots",
        "urlPath": "/6-robots",
        "content": "# ROBOTS.md\n\nThis file provides guidance to AI assistants when working with code in this repository.\n\n### Tech stack\n\n- **Next.js 15** with App Router architecture\n- **TypeScript** for type safety\n- **TailwindCSS & Shadcn** for styling\n\n<!-- section-1 -->\n\n# General rules:\n\n- Don't include any comments in any files.\n- All errors should be thrown - no \"fallback\" functionality\n- Import \"cn\" from \"@/lib/utils\" to concatenate classes.\n\n# File Organization and Naming Conventions\n\n- Types and store files alongside ancestor files\n- Actions and hooks files alongside descendent files\n\n\\`\\`\\`\n\n# Hook, action, store and type patterns\n\n<!-- section-2 -->\n\n# Console.logging\n\nAll logging should be performed using the \\`conditionalLog\\` function exported from \\`lib/log.utils.ts\\`\nThe \\`NEXT_PUBLIC_LOG_LABELS\\` variable in \\`.env.local\\` stores a comma separated string of log labels. Logs are returned if \\`NEXT_PUBLIC_LOG_LABELS=\"all\"\\`, or if \\`NEXT_PUBLIC_LOG_LABELS\\` includes the label arg in \\`conditionalLog\\`.\n\n\\`\\`\\`\n",
        "components": [],
        "sections": {
          "section1": {
            "option1": {
              "content": "- **Postgres & Prisma** for database and ORM\n- **Supabase** for authentication and real-time features\n\n# Database Architecture\n\nUse Supabase as the primary database and authentication provider.",
              "include": true
            },
            "option2": {
              "content": "- **Postgres & Prisma** for database and ORM\n- **NeonDB** for serverless Postgres\n- **Better-Auth** for authentication\n\n# Database Architecture\n\nUse NeonDB for serverless Postgres with Prisma ORM and Better-Auth for authentication.",
              "include": true
            },
            "option3": {
              "content": "- **Postgres & Prisma** for database and ORM\n- **Supabase** for real-time features\n- **NeonDB** for serverless Postgres\n- **Better-Auth** for authentication\n\n# Database Architecture\n\nUse both Supabase and NeonDB based on feature requirements. Use Better-Auth for authentication with NeonDB as the primary database.",
              "include": true
            },
            "option4": {
              "content": "# Database Architecture\n\nNo database required - this is a frontend-only application.",
              "include": true
            }
          },
          "section2": {
            "option1": {
              "content": "DB <-> Supabase Client <-> hook <-> store\n\n- Supabase client queries are called directly in react-query hooks.\n- Data returned in the onSuccess function of react-query hooks is used to update the corresponding zustand store (if applicable).\n- Loading and error state is managed via the react-query hooks, NOT the zustand store.\n- All db types should be defined from `@/integrations/supabase/types`.\n\n## Example of file patterns - [`util.md`](util.md)\n\nFollow the examples outlined in [`util.md`](util.md) when working on hook, store or type files.",
              "include": true
            },
            "option2": {
              "content": "DB <-> Action <-> hook <-> store\n\n- Better-auth client methods are called directly in react-query hooks.\n- Prisma client queries are called in actions via getAuthenticatedClient.\n- Actions are called via react-query hooks.\n- Data returned in the onSuccess function of react-query hooks is used to update the corresponding zustand store.\n- Loading and error state is managed via the react-query hooks, NOT the zustand store.\n- All db types should be defined from `\"@prisma/client\"`\n\n## Example of file patterns - [`util.md`](util.md)\n\nFollow the examples outlined in [`util.md`](util.md) when working on hook, action, store or type files. The file also contains the `prisma-rls.ts` and `action.util.ts` files for reference.",
              "include": true
            },
            "option3": {
              "content": "DB <-> Action/Supabase Client <-> hook <-> store\n\n- Better-auth client methods are called directly in react-query hooks.\n- Prisma client queries are called in actions via getAuthenticatedClient for NeonDB.\n- Supabase client queries are called directly in react-query hooks for real-time features.\n- Actions are called via react-query hooks.\n- Data returned in the onSuccess function of react-query hooks is used to update the corresponding zustand store.\n- Loading and error state is managed via the react-query hooks, NOT the zustand store.\n- Database types should be defined from `\"@prisma/client\"` for NeonDB and `@/integrations/supabase/types` for Supabase.",
              "include": true
            },
            "option4": {
              "content": "Component <-> hook <-> store\n\n- No database interactions - frontend only.\n- API calls (if any) are made directly in react-query hooks.\n- Data returned in the onSuccess function of react-query hooks is used to update the corresponding zustand store.\n- Loading and error state is managed via the react-query hooks, NOT the zustand store.\n- All types should be defined in `.types.ts` files alongside components.\n\n## Example of file patterns - [`util.md`](util.md)\n\nFollow the examples outlined in [`util.md`](util.md) when working on hook, store or type files.",
              "include": true
            }
          }
        },
        "include": true,
        "includeInSidebar": false,
        "isDynamicRobotsFile": true,
        "visibleAfterPage": "readme"
      },
      {
        "id": "7-deployment",
        "name": "7-deployment",
        "displayName": " 7-Deployment",
        "type": "file",
        "path": "7-deployment",
        "urlPath": "/7-deployment",
        "content": "# Deployment Instructions\n\nThis guide provides step-by-step instructions for deploying your application based on your selected technology stack.\n\n## Platform Setup\n\n<!-- section-1 -->\n\n## Database Deployment\n\n<!-- section-2 -->\n\n## Environment Variables\n\n<!-- section-3 -->\n\n## Authentication Setup\n\n<!-- section-4 -->\n\n## Post-Deployment Tasks\n\n<!-- section-5 -->\n",
        "components": [],
        "sections": {
          "section1": {
            "option1": {
              "content": "### Deploying to Vercel\n\n**Prerequisites:**\n- Vercel account\n- GitHub repository connected to Vercel\n\n**Steps:**\n\n1. Install Vercel CLI:\n```bash\nnpm install -g vercel\n```\n\n2. Login to Vercel:\n```bash\nvercel login\n```\n\n3. Deploy your application:\n```bash\nvercel\n```\n\n4. For production deployment:\n```bash\nvercel --prod\n```\n\n**Configuration:**\n- Vercel automatically detects Next.js projects\n- Environment variables should be set in the Vercel dashboard under Settings → Environment Variables\n- Build command: `npm run build`\n- Output directory: `.next`\n- Install command: `npm install`\n\n**Custom Domain:**\n1. Go to your project settings in Vercel dashboard\n2. Navigate to Domains\n3. Add your custom domain\n4. Update your DNS records as instructed\n\n**Continuous Deployment:**\n- Vercel automatically deploys on push to your main branch\n- Pull requests create preview deployments\n- Configure branch deployments in Settings → Git",
              "include": true
            },
            "option2": {
              "content": "### Deploying to Railway\n\n**Prerequisites:**\n- Railway account\n- GitHub repository\n\n**Steps:**\n\n1. Install Railway CLI:\n```bash\nnpm install -g @railway/cli\n```\n\n2. Login to Railway:\n```bash\nrailway login\n```\n\n3. Initialize your project:\n```bash\nrailway init\n```\n\n4. Link to your Railway project:\n```bash\nrailway link\n```\n\n5. Deploy your application:\n```bash\nrailway up\n```\n\n**Configuration:**\n\nCreate a `railway.json` file in your project root:\n```json\n{\n  \"$schema\": \"https://railway.app/railway.schema.json\",\n  \"build\": {\n    \"builder\": \"NIXPACKS\"\n  },\n  \"deploy\": {\n    \"startCommand\": \"npm start\",\n    \"restartPolicyType\": \"ON_FAILURE\",\n    \"restartPolicyMaxRetries\": 10\n  }\n}\n```\n\n**Environment Variables:**\n- Set in Railway dashboard under Variables tab\n- Or use CLI: `railway variables set KEY=value`\n\n**Health Checks:**\nRailway automatically monitors your application. Configure health check endpoint in your application:\n```typescript\napp.get('/health', (req, res) => {\n  res.status(200).json({ status: 'healthy' });\n});\n```\n\n**Custom Domain:**\n1. Go to Settings in Railway dashboard\n2. Navigate to Domains\n3. Add custom domain\n4. Update DNS records with provided values\n\n**Scaling:**\n- Railway supports horizontal and vertical scaling\n- Configure in Settings → Resources\n- Adjust memory and CPU allocation as needed",
              "include": true
            }
          },
          "section2": {
            "option1": {
              "content": "### No Database Deployment\n\nYour application is configured without a database backend. No additional database setup is required.\n\n**Static Content:**\n- All data is client-side only\n- Consider using environment variables for configuration\n- Perfect for static sites and applications without persistent data",
              "include": true
            },
            "option2": {
              "content": "### NeonDB Deployment\n\n**Prerequisites:**\n- NeonDB account (sign up at [neon.tech](https://neon.tech))\n\n**Steps:**\n\n1. Create a new project in NeonDB dashboard\n2. Copy your connection string from the dashboard\n3. Set environment variable in your deployment platform:\n   - `DATABASE_URL=your-neondb-connection-string`\n\n**Database Schema Setup:**\n\n1. Generate Prisma client:\n```bash\nnpx prisma generate\n```\n\n2. Push schema to database:\n```bash\nnpx prisma db push\n```\n\n3. Or use migrations:\n```bash\nnpx prisma migrate deploy\n```\n\n**Connection Pooling:**\nNeonDB provides built-in connection pooling. Use the pooled connection string for serverless environments.\n\n**Branching:**\nNeonDB supports database branching:\n- Create branches for preview deployments\n- Automatically create database branches per pull request\n- Configure in your CI/CD pipeline\n\n**Monitoring:**\n- Access database metrics in NeonDB dashboard\n- Set up alerts for connection limits\n- Monitor query performance",
              "include": true
            },
            "option3": {
              "content": "### Supabase Deployment\n\n**Prerequisites:**\n- Supabase account (sign up at [supabase.com](https://supabase.com))\n\n**Steps:**\n\n1. Create a new project in Supabase dashboard\n2. Note your project URL and anon key\n3. Set environment variables in your deployment platform:\n   - `VITE_SUPABASE_URL=your-project-url`\n   - `VITE_SUPABASE_ANON_KEY=your-anon-key`\n   - `DATABASE_URL=your-connection-string` (for Prisma)\n\n**Database Schema Setup:**\n\n1. Generate Prisma client:\n```bash\nnpx prisma generate\n```\n\n2. Push schema to database:\n```bash\nnpx prisma db push\n```\n\n**Row Level Security (RLS):**\nEnable RLS policies through Supabase dashboard:\n1. Navigate to Authentication → Policies\n2. Create policies for each table\n3. Test policies using the SQL editor\n\n**Storage Setup:**\nIf using Supabase Storage:\n1. Create storage buckets in dashboard\n2. Configure bucket policies\n3. Set CORS policies if needed\n\n**Realtime Setup:**\nEnable realtime for tables:\n1. Go to Database → Replication\n2. Enable replication for tables\n3. Configure realtime listeners in your application\n\n**Edge Functions (Optional):**\nDeploy edge functions for server-side logic:\n```bash\nsupabase functions deploy function-name\n```\n\n**Monitoring:**\n- Access logs in Supabase dashboard\n- Monitor API usage and database performance\n- Set up error tracking",
              "include": true
            }
          },
          "section3": {
            "option1": {
              "content": "### Core Environment Variables\n\nRequired for all deployments:\n\n```env\nNODE_ENV=production\nVITE_APP_URL=https://your-domain.com\n```",
              "include": true
            },
            "option2": {
              "content": "### Database Environment Variables\n\n**For NeonDB:**\n```env\nDATABASE_URL=postgresql://user:password@ep-xxx.us-east-2.aws.neon.tech/dbname\n```\n\n**For Supabase:**\n```env\nVITE_SUPABASE_URL=https://xxx.supabase.co\nVITE_SUPABASE_ANON_KEY=your-anon-key\nDATABASE_URL=postgresql://postgres:password@db.xxx.supabase.co:5432/postgres\n```",
              "include": true
            },
            "option3": {
              "content": "### Better Auth Environment Variables\n\n```env\nBETTER_AUTH_SECRET=your-secret-key-min-32-chars\nBETTER_AUTH_URL=https://your-domain.com\n```\n\nGenerate a secure secret:\n```bash\nopenssl rand -base64 32\n```",
              "include": true
            },
            "option4": {
              "content": "### Email Service (Resend)\n\n```env\nRESEND_API_KEY=re_xxxxxxxxxxxx\nVITE_FROM_EMAIL=noreply@yourdomain.com\n```\n\nGet your API key from [resend.com/api-keys](https://resend.com/api-keys)",
              "include": true
            },
            "option5": {
              "content": "### Stripe Payment Variables\n\n```env\nSTRIPE_SECRET_KEY=sk_live_xxxxxxxxxxxx\nVITE_STRIPE_PUBLISHABLE_KEY=pk_live_xxxxxxxxxxxx\nSTRIPE_WEBHOOK_SECRET=whsec_xxxxxxxxxxxx\n```\n\n**Setup:**\n1. Get keys from Stripe Dashboard\n2. Set up webhook endpoint at `/api/webhooks/stripe`\n3. Configure webhook events: `checkout.session.completed`, `customer.subscription.updated`, `customer.subscription.deleted`",
              "include": true
            },
            "option6": {
              "content": "### PayPal Payment Variables\n\n```env\nPAYPAL_CLIENT_ID=xxxxxxxxxxxx\nPAYPAL_CLIENT_SECRET=xxxxxxxxxxxx\nPAYPAL_MODE=live\n```\n\n**Setup:**\n1. Create app in PayPal Developer Dashboard\n2. Get credentials from app settings\n3. Use `sandbox` mode for testing, `live` for production",
              "include": true
            },
            "option7": {
              "content": "### OpenRouter AI Variables\n\n```env\nOPENROUTER_API_KEY=sk-or-xxxxxxxxxxxx\n```\n\nGet your API key from [openrouter.ai/keys](https://openrouter.ai/keys)",
              "include": true
            },
            "option8": {
              "content": "### OAuth Provider Variables (Google)\n\n```env\nGOOGLE_CLIENT_ID=xxxxxxxxxxxx.apps.googleusercontent.com\nGOOGLE_CLIENT_SECRET=xxxxxxxxxxxx\n```\n\n**Setup:**\n1. Create project in Google Cloud Console\n2. Enable Google+ API\n3. Create OAuth 2.0 credentials\n4. Add authorized redirect URI: `https://your-domain.com/api/auth/callback/google`",
              "include": true
            },
            "option9": {
              "content": "### OAuth Provider Variables (GitHub)\n\n```env\nGITHUB_CLIENT_ID=xxxxxxxxxxxx\nGITHUB_CLIENT_SECRET=xxxxxxxxxxxx\n```\n\n**Setup:**\n1. Go to GitHub Settings → Developer settings → OAuth Apps\n2. Create new OAuth App\n3. Set callback URL: `https://your-domain.com/api/auth/callback/github`",
              "include": true
            },
            "option10": {
              "content": "### OAuth Provider Variables (Apple)\n\n```env\nAPPLE_CLIENT_ID=com.yourapp.service\nAPPLE_TEAM_ID=xxxxxxxxxxxx\nAPPLE_KEY_ID=xxxxxxxxxxxx\nAPPLE_PRIVATE_KEY=\"-----BEGIN PRIVATE KEY-----\\n...\\n-----END PRIVATE KEY-----\"\n```\n\n**Setup:**\n1. Create Service ID in Apple Developer Account\n2. Configure Sign in with Apple\n3. Generate private key\n4. Set return URL: `https://your-domain.com/api/auth/callback/apple`",
              "include": true
            }
          },
          "section4": {
            "option1": {
              "content": "### Authentication Setup (Better Auth)\n\n**Database Schema:**\nBetter Auth creates necessary tables automatically on first run. Ensure your database is accessible.\n\n**Email Provider Setup:**\nConfigure Resend for email authentication:\n1. Verify your domain in Resend dashboard\n2. Add SPF and DKIM records to your DNS\n3. Test email delivery\n\n**Magic Link Setup:**\nMagic links are automatically configured if enabled. Ensure:\n- `BETTER_AUTH_URL` is set to your production domain\n- Email provider is configured correctly\n\n**Two-Factor Authentication:**\n2FA tables are created automatically. Users can enable in their account settings.\n\n**Session Management:**\n- Sessions are stored in database\n- Default expiration: 30 days\n- Refresh tokens enabled by default\n\n**Passkey Setup:**\nPasskeys require HTTPS:\n- Ensure your domain has valid SSL certificate\n- Passkeys stored securely in database\n- Works with biometric authentication",
              "include": true
            },
            "option2": {
              "content": "### Authentication Setup (Supabase Auth)\n\n**Email Templates:**\nCustomize email templates in Supabase dashboard:\n1. Navigate to Authentication → Email Templates\n2. Customize confirmation, magic link, and password reset emails\n3. Add your branding and domain\n\n**OAuth Providers:**\nConfigure in Supabase dashboard under Authentication → Providers:\n- Add client IDs and secrets\n- Set redirect URLs\n- Enable providers\n\n**Email Confirmation:**\nConfigure email confirmation settings:\n- Require email confirmation for new signups\n- Set confirmation token expiration\n- Configure redirect URLs\n\n**Password Requirements:**\nSet password policies:\n- Minimum length\n- Require special characters\n- Password history\n\n**Session Management:**\n- Sessions managed by Supabase\n- Configure JWT expiry\n- Set up refresh token rotation",
              "include": true
            },
            "option3": {
              "content": "### Organization Setup (Better Auth)\n\n**Super Admin Creation:**\nCreate your first super admin using the CLI:\n\n```bash\nnpm run create-super-admin\n```\n\nOr manually insert into database:\n```sql\nINSERT INTO users (email, role)\nVALUES ('admin@yourdomain.com', 'super_admin');\n```\n\n**Organization Creation:**\nSuper admins can create organizations through the admin panel or API.\n\n**Role Assignment:**\n- Super admins: Full system access\n- Org admins: Manage their organization and members\n- Org members: Read access to organization data\n\n**RLS Policies:**\nEnsure Row Level Security policies are enabled for organization tables:\n- Users can only see their organization data\n- Org admins can manage org members\n- Super admins have full access",
              "include": true
            }
          },
          "section5": {
            "option1": {
              "content": "### Stripe Webhook Configuration\n\n**Create Webhook Endpoint:**\n1. Go to Stripe Dashboard → Developers → Webhooks\n2. Add endpoint: `https://your-domain.com/api/webhooks/stripe`\n3. Select events to listen for:\n   - `checkout.session.completed`\n   - `customer.subscription.created`\n   - `customer.subscription.updated`\n   - `customer.subscription.deleted`\n   - `invoice.paid`\n   - `invoice.payment_failed`\n\n4. Copy the webhook signing secret\n5. Add to environment variables as `STRIPE_WEBHOOK_SECRET`\n\n**Test Webhook:**\n```bash\nstripe listen --forward-to localhost:3000/api/webhooks/stripe\n```\n\n**Webhook Handler:**\nVerify webhook signatures in your handler to ensure security.",
              "include": true
            },
            "option2": {
              "content": "### PayPal Webhook Configuration\n\n**Create Webhook:**\n1. Go to PayPal Developer Dashboard\n2. Select your app\n3. Add webhook URL: `https://your-domain.com/api/webhooks/paypal`\n4. Select events:\n   - `PAYMENT.CAPTURE.COMPLETED`\n   - `PAYMENT.CAPTURE.DENIED`\n   - `BILLING.SUBSCRIPTION.ACTIVATED`\n   - `BILLING.SUBSCRIPTION.CANCELLED`\n\n**Verify Webhooks:**\nPayPal provides webhook signature verification. Implement in your handler.",
              "include": true
            },
            "option3": {
              "content": "### Health Checks (Railway)\n\n**Configure Health Check Endpoint:**\nCreate endpoint at `/health` or `/api/health`:\n\n```typescript\nexport async function GET() {\n  return Response.json({\n    status: 'healthy',\n    timestamp: new Date().toISOString(),\n    uptime: process.uptime()\n  });\n}\n```\n\n**Railway Configuration:**\nRailway automatically detects health checks. Configure in `railway.json`:\n\n```json\n{\n  \"deploy\": {\n    \"healthcheckPath\": \"/health\",\n    \"healthcheckTimeout\": 300\n  }\n}\n```",
              "include": true
            },
            "option4": {
              "content": "### Domain and SSL Setup (Vercel)\n\n**Add Custom Domain:**\n1. Go to project settings in Vercel\n2. Navigate to Domains tab\n3. Add your domain\n\n**DNS Configuration:**\nAdd these records to your DNS provider:\n- A record: `76.76.21.21`\n- AAAA record: `2606:4700:4700::1111`\n\nOr use CNAME:\n- CNAME: `cname.vercel-dns.com`\n\n**SSL Certificate:**\n- Vercel automatically provisions SSL certificates\n- Certificates auto-renew\n- HTTPS enforced by default\n\n**Redirect www to apex:**\nConfigure in Vercel dashboard or use redirect in `vercel.json`",
              "include": true
            },
            "option5": {
              "content": "### Domain and SSL Setup (Railway)\n\n**Add Custom Domain:**\n1. Go to your project settings\n2. Click on Domains\n3. Add custom domain\n\n**DNS Configuration:**\nPoint your domain to Railway:\n- CNAME record: `your-app.up.railway.app`\n- Or use A records provided by Railway\n\n**SSL Certificate:**\n- Railway automatically provisions Let's Encrypt certificates\n- Auto-renewal enabled\n- HTTPS enforced\n\n**Domain Verification:**\nMay require TXT record verification for some domains",
              "include": true
            },
            "option6": {
              "content": "### Email Deliverability (Resend)\n\n**Domain Verification:**\n1. Add domain in Resend dashboard\n2. Add DNS records:\n   - SPF: `v=spf1 include:resend.com ~all`\n   - DKIM: Provided by Resend\n   - DMARC: `v=DMARC1; p=none;`\n\n**Verification:**\n- Verify domain in Resend dashboard\n- Test email delivery\n- Monitor bounce rates\n\n**Best Practices:**\n- Use verified domain for production\n- Set up DMARC policy to `quarantine` or `reject` after testing\n- Monitor email reputation",
              "include": true
            },
            "option7": {
              "content": "### Monitoring and Logging\n\n**Application Monitoring:**\n- Set up error tracking (Sentry, LogRocket)\n- Monitor API response times\n- Track user analytics\n\n**Database Monitoring:**\n- Monitor connection pool usage\n- Set up slow query alerts\n- Track database size and growth\n\n**Platform Monitoring:**\n- Use platform-provided metrics\n- Set up uptime monitoring\n- Configure alerts for downtime\n\n**Log Aggregation:**\nConsider log aggregation service:\n- Logtail\n- Datadog\n- New Relic",
              "include": true
            },
            "option8": {
              "content": "### File Storage Setup (Supabase)\n\n**Create Storage Buckets:**\n1. Go to Supabase dashboard → Storage\n2. Create new bucket\n3. Configure bucket as public or private\n\n**Bucket Policies:**\nSet up access policies:\n```sql\nCREATE POLICY \"Public Access\"\nON storage.objects FOR SELECT\nUSING (bucket_id = 'public-bucket');\n\nCREATE POLICY \"Authenticated Upload\"\nON storage.objects FOR INSERT\nTO authenticated\nWITH CHECK (bucket_id = 'user-uploads');\n```\n\n**CORS Configuration:**\nConfigure CORS if accessing from different domain:\n1. Go to Storage → Configuration\n2. Add allowed origins\n3. Set allowed methods\n\n**CDN:**\nSupabase Storage includes CDN. Use transformation parameters for images:\n```\nhttps://xxx.supabase.co/storage/v1/object/public/bucket/image.jpg?width=500\n```",
              "include": true
            },
            "option9": {
              "content": "### Realtime Setup (Supabase)\n\n**Enable Replication:**\n1. Go to Database → Replication\n2. Enable for tables you want realtime updates\n3. Configure publication settings\n\n**Security:**\nSet up RLS policies for realtime:\n```sql\nALTER TABLE messages ENABLE ROW LEVEL SECURITY;\n\nCREATE POLICY \"Users can see their messages\"\nON messages FOR SELECT\nUSING (auth.uid() = user_id);\n```\n\n**Client Configuration:**\nRealtime subscriptions are automatic with Supabase client. Ensure proper channel naming and filtering.\n\n**Monitoring:**\n- Monitor connection count\n- Check message delivery latency\n- Set up alerts for connection issues",
              "include": true
            },
            "option10": {
              "content": "### Post-Deployment Verification\n\n**Checklist:**\n- [ ] Application loads correctly at production URL\n- [ ] Database migrations applied successfully\n- [ ] All environment variables set correctly\n- [ ] Authentication flow works (sign up, login, logout)\n- [ ] Email delivery working\n- [ ] Payment processing functional (if applicable)\n- [ ] File uploads working (if applicable)\n- [ ] API endpoints responding correctly\n- [ ] SSL certificate valid and auto-renewing\n- [ ] Monitoring and logging configured\n- [ ] Error tracking set up\n- [ ] Backups configured\n- [ ] Domain DNS propagated\n\n**Load Testing:**\nTest your application under load:\n```bash\nnpm install -g artillery\nartillery quick --count 100 --num 10 https://your-domain.com\n```\n\n**Security Scan:**\n- Run security audit: `npm audit`\n- Check for exposed secrets\n- Verify CORS settings\n- Test rate limiting\n- Verify CSP headers",
              "include": true
            }
          }
        },
        "include": true,
        "includeInSidebar": false,
        "isDynamicRobotsFile": false
      },
      {
        "id": "code-files",
        "name": "code-files",
        "displayName": "Code files",
        "type": "directory",
        "path": "code-files",
        "urlPath": "/code-files",
        "include": true,
        "includeInSidebar": true,
        "children": []
      }
    ]
  },
  "flatIndex": {
    "": {
      "id": "root",
      "name": "root",
      "displayName": "Root",
      "type": "directory",
      "path": "",
      "urlPath": "/",
      "include": true,
      "children": [
        {
          "id": "readme",
          "name": "readme",
          "displayName": "README",
          "type": "file",
          "order": 1,
          "path": "readme",
          "urlPath": "/readme",
          "content": "<!-- component-READMEComponent -->\n",
          "components": [
            {
              "id": "component-READMEComponent",
              "name": "READMEComponent",
              "displayName": "READMEComponent",
              "type": "component",
              "path": "readme.component.READMEComponent",
              "urlPath": "",
              "componentId": "READMEComponent",
              "include": true
            }
          ],
          "sections": {},
          "include": true,
          "includeInSidebar": true,
          "isDynamicRobotsFile": false
        },
        {
          "id": "theme",
          "name": "theme",
          "displayName": "Theme",
          "type": "file",
          "order": 2,
          "path": "theme",
          "urlPath": "/theme",
          "content": "# Theme configuration\n\nSelect and customize your theme! These styles will be applied to every component in your generated web app.\n\n<!-- component-ThemeConfiguration -->\n",
          "components": [
            {
              "id": "component-ThemeConfiguration",
              "name": "ThemeConfiguration",
              "displayName": "ThemeConfiguration",
              "type": "component",
              "path": "theme.component.ThemeConfiguration",
              "urlPath": "",
              "componentId": "ThemeConfiguration",
              "include": true
            }
          ],
          "sections": {},
          "include": true,
          "includeInSidebar": true,
          "isDynamicRobotsFile": false
        },
        {
          "id": "app-directory",
          "name": "app-directory",
          "displayName": "App Directory",
          "type": "file",
          "order": 3,
          "path": "app-directory",
          "urlPath": "/app-directory",
          "content": "# App Directory\n\nThe app directory provides a site map, a UI layout heirarchy, and a data management strategy.\n\n<!-- component-LayoutAndStructure -->\n",
          "components": [
            {
              "id": "component-LayoutAndStructure",
              "name": "LayoutAndStructure",
              "displayName": "LayoutAndStructure",
              "type": "component",
              "path": "app-directory.component.LayoutAndStructure",
              "urlPath": "",
              "componentId": "LayoutAndStructure",
              "include": true
            }
          ],
          "sections": {},
          "include": true,
          "includeInSidebar": true,
          "isDynamicRobotsFile": false
        },
        {
          "id": "database",
          "name": "database",
          "displayName": "Database",
          "type": "file",
          "order": 4,
          "path": "database",
          "urlPath": "/database",
          "content": "# Database\n\n<!-- component-DatabaseConfiguration -->\n",
          "components": [
            {
              "id": "component-DatabaseConfiguration",
              "name": "DatabaseConfiguration",
              "displayName": "DatabaseConfiguration",
              "type": "component",
              "path": "database.component.DatabaseConfiguration",
              "urlPath": "",
              "componentId": "DatabaseConfiguration",
              "include": true
            }
          ],
          "sections": {},
          "include": true,
          "includeInSidebar": true,
          "isDynamicRobotsFile": false
        },
        {
          "id": "environment",
          "name": "environment",
          "displayName": "Environment",
          "type": "file",
          "order": 5,
          "path": "environment",
          "urlPath": "/environment",
          "content": "# Environment\n\n<!-- component-NextStepsComponent -->\n",
          "components": [
            {
              "id": "component-NextStepsComponent",
              "name": "NextStepsComponent",
              "displayName": "NextStepsComponent",
              "type": "component",
              "path": "environment.component.NextStepsComponent",
              "urlPath": "",
              "componentId": "NextStepsComponent",
              "include": true
            }
          ],
          "sections": {},
          "include": true,
          "includeInSidebar": true,
          "isDynamicRobotsFile": false
        },
        {
          "id": "extensions",
          "name": "extensions",
          "displayName": "Extensions",
          "type": "file",
          "order": 6,
          "path": "extensions",
          "urlPath": "/extensions",
          "content": "# Extensions\n\n<!-- component-ExtensionsComponent -->\n",
          "components": [
            {
              "id": "component-ExtensionsComponent",
              "name": "ExtensionsComponent",
              "displayName": "ExtensionsComponent",
              "type": "component",
              "path": "extensions.component.ExtensionsComponent",
              "urlPath": "",
              "componentId": "ExtensionsComponent",
              "include": true
            }
          ],
          "sections": {},
          "include": true,
          "includeInSidebar": true,
          "isDynamicRobotsFile": false
        },
        {
          "id": "10-util",
          "name": "10-util",
          "displayName": " 10-util",
          "type": "file",
          "path": "10-util",
          "urlPath": "/10-util",
          "content": "# File examples\n\nThis guide provides code examples and patterns for organizing your application code following best practices.\n\n## Types file example\n\nType definitions establish contracts and ensure type safety throughout your application.\n\n<!-- section-1 -->\n\n## Stores file example\n\nZustand stores manage application state with persistence and middleware support.\n\n<!-- section-2 -->\n\n## Actions file example\n\nServer actions handle data mutations and communicate with your backend services.\n\n<!-- section-3 -->\n\n## Hooks file example\n\nReact Query hooks manage data fetching, caching, and synchronization.\n\n<!-- section-4 -->\n\n## Utility files\n\nUtility modules provide reusable helper functions and configurations.\n\n<!-- section-5 -->\n",
          "components": [],
          "sections": {
            "section1": {
              "option1": {
                "content": "**Types file example (Client-side):**\n\n```typescript\nexport interface AppState {\n  data: any[];\n  setData: (data: any[]) => void;\n  isLoading: boolean;\n  setIsLoading: (isLoading: boolean) => void;\n  reset: () => void;\n}\n\nexport interface ApiData {\n  id: string;\n  name: string;\n  value: number;\n}\n```",
                "include": true
              },
              "option2": {
                "content": "**Types file example (With Database):**\n\n```typescript\nimport { User } from \"@prisma/client\";\n\nexport interface AppState {\n  user: User | null;\n  setUser: (user: User | null) => void;\n  tempEmail?: string;\n  setTempEmail: (tempEmail: string) => void;\n  reset: () => void;\n}\n\nexport interface SignInData {\n  email: string;\n  password: string;\n}\n```",
                "include": true
              }
            },
            "section2": {
              "option1": {
                "content": "### Store Example (With Database)\n\n```typescript\nimport { UserRole } from \"@prisma/client\";\nimport { create } from \"zustand\";\nimport { persist } from \"zustand/middleware\";\nimport { AppState, ExtendedUser, RedirectState } from \"./layout.types\";\n\nconst initialState = {\n  user: null,\n};\n\nexport const useAppStore = create<AppState>()((set) => ({\n  ...initialState,\n  setUser: (user) => set({ user, profile: user?.profile || null }),\n  reset: () => set(initialState),\n}));\n```\n\n**Usage with React Query:**\n```typescript\nimport { useAppStore } from \"@/stores/app.stores\";\nimport { useGetUser } from \"@/hooks/user.hooks\";\n\nexport const UserProfile = () => {\n  const setUser = useAppStore((state) => state.setUser);\n  const user = useAppStore((state) => state.user);\n\n  const { isLoading } = useGetUser({\n    onSuccess: (data) => setUser(data),\n  });\n\n  if (isLoading) return <div>Loading...</div>;\n\n  return <div>Welcome, {user?.name}</div>;\n};\n```",
                "include": true
              },
              "option2": {
                "content": "### Store Example (Without Database)\n\n```typescript\nimport { create } from \"zustand\";\nimport { persist } from \"zustand/middleware\";\n\ninterface AppState {\n  theme: \"light\" | \"dark\";\n  setTheme: (theme: \"light\" | \"dark\") => void;\n  sidebarOpen: boolean;\n  toggleSidebar: () => void;\n}\n\nexport const useAppStore = create<AppState>()(\n  persist(\n    (set) => ({\n      theme: \"light\",\n      setTheme: (theme) => set({ theme }),\n      sidebarOpen: true,\n      toggleSidebar: () => set((state) => ({ sidebarOpen: !state.sidebarOpen })),\n    }),\n    {\n      name: \"app-storage\",\n    }\n  )\n);\n```\n\n**Usage:**\n```typescript\nimport { useAppStore } from \"@/stores/app.stores\";\n\nexport const ThemeToggle = () => {\n  const { theme, setTheme } = useAppStore();\n\n  return (\n    <button onClick={() => setTheme(theme === \"light\" ? \"dark\" : \"light\")}>\n      Toggle Theme\n    </button>\n  );\n};\n```",
                "include": true
              }
            },
            "section3": {
              "option1": {
                "content": "**No actions file needed for client-side only applications.**\n\nUse API routes or external API calls directly in hooks with React Query.",
                "include": true
              },
              "option2": {
                "content": "**Actions file example (NeonDB + Better Auth):**\n\n```typescript\n\"use server\";\n\nimport { ActionResponse, getActionResponse } from \"@/lib/action.utils\";\nimport { auth } from \"@/lib/auth\";\nimport { getAuthenticatedClient } from \"@/lib/auth.utils\";\nimport { User } from \"@prisma/client\";\nimport { headers } from \"next/headers\";\n\nexport const getUserAction = async (): Promise<ActionResponse<User | null>> => {\n  try {\n    const session = await auth.api.getSession({\n      headers: await headers(),\n    });\n\n    if (!session?.user) return getActionResponse();\n\n    const { db } = await getAuthenticatedClient();\n\n    const prismaUser = await db.user.findUnique({\n      where: { id: session.user.id },\n    });\n\n    return getActionResponse({ data: prismaUser });\n  } catch (error) {\n    return getActionResponse({ error });\n  }\n};\n```",
                "include": true
              },
              "option3": {
                "content": "**Actions file example (Supabase + Better Auth):**\n\n```typescript\n\"use server\";\n\nimport { ActionResponse, getActionResponse } from \"@/lib/action.utils\";\nimport { auth } from \"@/lib/auth\";\nimport { getAuthenticatedClient } from \"@/lib/auth.utils\";\nimport { User } from \"@prisma/client\";\nimport { headers } from \"next/headers\";\n\nexport const getUserAction = async (): Promise<ActionResponse<User | null>> => {\n  try {\n    const session = await auth.api.getSession({\n      headers: await headers(),\n    });\n\n    if (!session?.user) return getActionResponse();\n\n    const { db } = await getAuthenticatedClient();\n\n    const prismaUser = await db.user.findUnique({\n      where: { id: session.user.id },\n    });\n\n    return getActionResponse({ data: prismaUser });\n  } catch (error) {\n    return getActionResponse({ error });\n  }\n};\n```",
                "include": true
              },
              "option4": {
                "content": "**Actions file example (Supabase Auth Only):**\n\n```typescript\n\"use server\";\n\nimport { createClient } from \"@/lib/supabase/server\";\nimport { ActionResponse, getActionResponse } from \"@/lib/action.utils\";\n\nexport const getUserAction = async (): Promise<ActionResponse<any>> => {\n  try {\n    const supabase = await createClient();\n\n    const { data: { user }, error: authError } = await supabase.auth.getUser();\n\n    if (authError || !user) {\n      return getActionResponse({ error: authError?.message || \"Not authenticated\" });\n    }\n\n    const { data, error } = await supabase\n      .from('users')\n      .select('*')\n      .eq('id', user.id)\n      .single();\n\n    if (error) throw error;\n\n    return getActionResponse({ data });\n  } catch (error) {\n    return getActionResponse({ error });\n  }\n};\n```",
                "include": true
              }
            },
            "section4": {
              "option1": {
                "content": "**Hooks file example (Client-side):**\n\n```typescript\n\"use client\";\n\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { useRouter } from \"next/navigation\";\nimport { useAppStore } from \"../layout.stores\";\n\nexport const useGetData = () => {\n  const { setData } = useAppStore();\n\n  return useQuery({\n    queryKey: [\"data\"],\n    queryFn: async () => {\n      const response = await fetch(\"/api/data\");\n      if (!response.ok) throw new Error(\"Failed to fetch\");\n      const data = await response.json();\n      setData(data);\n      return data;\n    },\n    staleTime: 1000 * 60 * 5,\n  });\n};\n\nexport const useCreateData = () => {\n  const router = useRouter();\n\n  return useMutation({\n    mutationFn: async (newData: any) => {\n      const response = await fetch(\"/api/data\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify(newData),\n      });\n      if (!response.ok) throw new Error(\"Failed to create\");\n      return response.json();\n    },\n    onSuccess: () => {\n      router.refresh();\n    },\n  });\n};\n```",
                "include": true
              },
              "option2": {
                "content": "**Hooks file example (Better Auth):**\n\n```typescript\n\"use client\";\n\nimport { configuration, privatePaths } from \"@/configuration\";\nimport { signIn } from \"@/lib/auth-client\";\nimport { useMutation, useQuery } from \"@tanstack/react-query\";\nimport { usePathname, useRouter } from \"next/navigation\";\nimport { toast } from \"sonner\";\nimport { Toast } from \"../(components)/Toast\";\nimport { CypressDataAttributes } from \"../../types/cypress.types\";\nimport { useAppStore, useRedirectStore } from \"../layout.stores\";\nimport { SignInData } from \"../layout.types\";\nimport { getUserAction } from \"./layout.actions\";\nimport { useAuthLayoutStore } from \"./layout.stores\";\n\nexport const useGetUser = () => {\n  const { setUser, reset } = useAppStore();\n  const { reset: resetAuthLayout } = useAuthLayoutStore();\n  const { setUserData } = useRedirectStore();\n  const pathname = usePathname();\n\n  const router = useRouter();\n  return useQuery({\n    queryKey: [\"user\"],\n    queryFn: async () => {\n      const { data, error } = await getUserAction();\n      if (!data || error) {\n        if (privatePaths.includes(pathname)) {\n          router.push(configuration.paths.signIn);\n        }\n        reset();\n        resetAuthLayout();\n      }\n      if (error) throw error;\n      setUser(data ?? null);\n\n      setUserData(data);\n\n      return data;\n    },\n    staleTime: 1000 * 60 * 5,\n  });\n};\n\nexport const useSignIn = () => {\n  const { setUser, setTempEmail } = useAppStore();\n  const { setUserData } = useRedirectStore();\n  const router = useRouter();\n\n  return useMutation({\n    mutationFn: async (signInData: SignInData) => {\n      const { error } = await signIn.email({\n        email: signInData.email,\n        password: signInData.password,\n      });\n\n      if (error?.status === 403) setTempEmail(signInData.email);\n\n      if (error) throw error;\n      const { data: userData, error: userError } = await getUserAction();\n\n      if (userError) throw new Error(userError);\n\n      return userData;\n    },\n    onSuccess: (data) => {\n      if (data) {\n        setUser(data);\n        setUserData(data);\n      }\n      toast.custom(() => (\n        <Toast\n          variant=\"success\"\n          title=\"Success\"\n          message=\"Successfully signed in\"\n          data-cy={CypressDataAttributes.TOAST_SUCCESS}\n        />\n      ));\n      if (data && !data.profile?.isOnboardingComplete) {\n        router.push(configuration.paths.onboarding);\n        return;\n      }\n      router.push(configuration.paths.home);\n    },\n    onError: (\n      error: {\n        code?: string | undefined;\n        message?: string | undefined;\n        status: number;\n        statusText: string;\n      } | null\n    ) => {\n      if (error?.status === 403) return;\n      toast.custom(() => (\n        <Toast\n          variant=\"error\"\n          title=\"Sign In Failed\"\n          message={error?.message || \"Failed to sign in\"}\n          data-cy={CypressDataAttributes.TOAST_ERROR}\n        />\n      ));\n    },\n  });\n};\n```",
                "include": true
              },
              "option3": {
                "content": "**Hooks file example (Supabase Auth):**\n\n```typescript\n\"use client\";\n\nimport { createClient } from \"@/lib/supabase/client\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { useRouter } from \"next/navigation\";\nimport { useAppStore } from \"../layout.stores\";\n\nexport const useGetUser = () => {\n  const { setUser, reset } = useAppStore();\n  const router = useRouter();\n\n  return useQuery({\n    queryKey: [\"user\"],\n    queryFn: async () => {\n      const supabase = createClient();\n      const { data: { user }, error: authError } = await supabase.auth.getUser();\n\n      if (authError || !user) {\n        reset();\n        return null;\n      }\n\n      const { data, error } = await supabase\n        .from('users')\n        .select('*')\n        .eq('id', user.id)\n        .single();\n\n      if (error) throw error;\n\n      setUser(data);\n      return data;\n    },\n    staleTime: 1000 * 60 * 5,\n  });\n};\n\nexport const useSignIn = () => {\n  const { setUser } = useAppStore();\n  const router = useRouter();\n\n  return useMutation({\n    mutationFn: async ({ email, password }: { email: string; password: string }) => {\n      const supabase = createClient();\n      const { data, error } = await supabase.auth.signInWithPassword({\n        email,\n        password,\n      });\n\n      if (error) throw error;\n\n      return data.user;\n    },\n    onSuccess: (user) => {\n      setUser(user);\n      router.push('/dashboard');\n    },\n  });\n};\n```",
                "include": true
              }
            },
            "section5": {
              "option1": {
                "content": "**No utility files needed for client-side only applications.**",
                "include": true
              },
              "option2": {
                "content": "**Utility files (Better Auth + Prisma):**\n\n## `prisma-rls.ts`:\n\n```typescript\nimport { Prisma } from \"@prisma/client\";\nimport { prisma } from \"./prisma\";\n\nfunction forUser(userId: string, tenantId?: string) {\n  return Prisma.defineExtension((prisma) =>\n    prisma.$extends({\n      query: {\n        $allModels: {\n          async $allOperations({ args, query }) {\n            if (tenantId) {\n              const [, , result] = await prisma.$transaction([\n                prisma.$executeRaw`SELECT set_config('app.current_user_id', ${userId}, TRUE)`,\n                prisma.$executeRaw`SELECT set_config('app.current_tenant_id', ${tenantId}, TRUE)`,\n                query(args),\n              ]);\n              return result;\n            } else {\n              const [, result] = await prisma.$transaction([\n                prisma.$executeRaw`SELECT set_config('app.current_user_id', ${userId}, TRUE)`,\n                query(args),\n              ]);\n              return result;\n            }\n          },\n        },\n      },\n    })\n  );\n}\n\nexport function createRLSClient(userId: string, tenantId?: string) {\n  return prisma.$extends(forUser(userId, tenantId));\n}\n```\n\n## `auth.util.ts`\n\n```typescript\nimport { User } from \"better-auth\";\nimport jwt from \"jsonwebtoken\";\nimport { headers } from \"next/headers\";\nimport { auth, Session } from \"./auth\";\nimport { createRLSClient } from \"./prisma-rls\";\n\nexport async function getAuthenticatedClient(user?: User): Promise<{\n  db: ReturnType<typeof createRLSClient>;\n  session: Session | null;\n}> {\n  const headersList = await headers();\n\n  const session = await auth.api.getSession({\n    headers: headersList,\n  });\n\n  const userId = user?.id || session?.user.id;\n\n  if (!userId) {\n    throw new Error(\"Unauthorized\");\n  }\n\n  const db = createRLSClient(userId);\n\n  return { db, session };\n}\n\nexport function generateSupabaseJWT(userId: string, userRole: string): string {\n  const jwtSecret = process.env.SUPABASE_JWT_SECRET;\n\n  if (!jwtSecret) {\n    throw new Error(\"SUPABASE_JWT_SECRET is required for JWT generation\");\n  }\n\n  const payload = {\n    aud: \"authenticated\",\n    exp: Math.floor(Date.now() / 1000) + 60 * 60,\n    sub: userId,\n    email: `${userId}@better-auth.local`,\n    role: \"authenticated\",\n    user_metadata: {\n      better_auth_user_id: userId,\n      better_auth_role: userRole,\n    },\n    app_metadata: {\n      provider: \"better-auth\",\n      providers: [\"better-auth\"],\n    },\n  };\n\n  return jwt.sign(payload, jwtSecret, {\n    algorithm: \"HS256\",\n  });\n}\n```\n\n## `log.util.ts`:\n\n```typescript\nexport enum LOG_LABELS {\n  GENERATE = \"generate\",\n  API = \"api\",\n  AUTH = \"auth\",\n  DB = \"db\",\n  FETCH = \"fetch\",\n  RATE_LIMIT = \"rate-limit\",\n  IMAGE = \"image\",\n  WIDGET = \"widget\",\n}\n\ninterface ConditionalLogOptions {\n  maxStringLength?: number;\n  label: LOG_LABELS | string;\n}\n\nexport function conditionalLog(\n  data: unknown,\n  options: ConditionalLogOptions\n): string | null {\n  const { maxStringLength = 200, label } = options;\n\n  const logLabels = process.env.NEXT_PUBLIC_LOG_LABELS;\n\n  if (!logLabels || logLabels === \"none\") {\n    return null;\n  }\n\n  if (logLabels !== \"all\") {\n    const allowedLabels = logLabels.split(\",\").map((l) => l.trim());\n    if (!allowedLabels.includes(label)) {\n      return null;\n    }\n  }\n\n  try {\n    const processedData = deepStringify(data, maxStringLength, new WeakSet());\n    const result = JSON.stringify(processedData);\n    return result.replace(/\\\\s+/g, \"\");\n  } catch (error) {\n    return JSON.stringify({ error: \"Failed to stringify data\", label });\n  }\n}\n\nfunction deepStringify(\n  value: unknown,\n  maxLength: number,\n  seen: WeakSet<object>\n): unknown {\n  if (value === null || value === undefined) {\n    return value;\n  }\n\n  if (typeof value === \"string\") {\n    return truncateString(value, maxLength);\n  }\n\n  if (typeof value === \"number\" || typeof value === \"boolean\") {\n    return value;\n  }\n\n  if (value instanceof Date) {\n    return value.toISOString();\n  }\n\n  if (value instanceof Error) {\n    return {\n      name: value.name,\n      message: truncateString(value.message, maxLength),\n      stack: value.stack ? truncateString(value.stack, maxLength) : undefined,\n    };\n  }\n\n  if (typeof value === \"object\") {\n    if (seen.has(value)) {\n      return \"[Circular Reference]\";\n    }\n\n    seen.add(value);\n\n    if (Array.isArray(value)) {\n      const result = value.map((item) => deepStringify(item, maxLength, seen));\n      seen.delete(value);\n      return result;\n    }\n\n    const result: Record<string, unknown> = {};\n    for (const [key, val] of Object.entries(value)) {\n      result[key] = deepStringify(val, maxLength, seen);\n    }\n    seen.delete(value);\n    return result;\n  }\n\n  return String(value);\n}\n\nfunction truncateString(str: string, maxLength: number): string {\n  if (str.length <= maxLength) {\n    return str;\n  }\n\n  const startLength = Math.floor((maxLength - 3) / 2);\n  const endLength = maxLength - 3 - startLength;\n\n  return str.slice(0, startLength) + \"...\" + str.slice(-endLength);\n}\n```",
                "include": true
              },
              "option3": {
                "content": "**Utility files (Supabase):**\n\n## `log.util.ts`:\n\n```typescript\nexport enum LOG_LABELS {\n  GENERATE = \"generate\",\n  API = \"api\",\n  AUTH = \"auth\",\n  DB = \"db\",\n  FETCH = \"fetch\",\n  RATE_LIMIT = \"rate-limit\",\n  IMAGE = \"image\",\n  WIDGET = \"widget\",\n}\n\ninterface ConditionalLogOptions {\n  maxStringLength?: number;\n  label: LOG_LABELS | string;\n}\n\nexport function conditionalLog(\n  data: unknown,\n  options: ConditionalLogOptions\n): string | null {\n  const { maxStringLength = 200, label } = options;\n\n  const logLabels = process.env.NEXT_PUBLIC_LOG_LABELS;\n\n  if (!logLabels || logLabels === \"none\") {\n    return null;\n  }\n\n  if (logLabels !== \"all\") {\n    const allowedLabels = logLabels.split(\",\").map((l) => l.trim());\n    if (!allowedLabels.includes(label)) {\n      return null;\n    }\n  }\n\n  try {\n    const processedData = deepStringify(data, maxStringLength, new WeakSet());\n    const result = JSON.stringify(processedData);\n    return result.replace(/\\\\s+/g, \"\");\n  } catch (error) {\n    return JSON.stringify({ error: \"Failed to stringify data\", label });\n  }\n}\n\nfunction deepStringify(\n  value: unknown,\n  maxLength: number,\n  seen: WeakSet<object>\n): unknown {\n  if (value === null || value === undefined) {\n    return value;\n  }\n\n  if (typeof value === \"string\") {\n    return truncateString(value, maxLength);\n  }\n\n  if (typeof value === \"number\" || typeof value === \"boolean\") {\n    return value;\n  }\n\n  if (value instanceof Date) {\n    return value.toISOString();\n  }\n\n  if (value instanceof Error) {\n    return {\n      name: value.name,\n      message: truncateString(value.message, maxLength),\n      stack: value.stack ? truncateString(value.stack, maxLength) : undefined,\n    };\n  }\n\n  if (typeof value === \"object\") {\n    if (seen.has(value)) {\n      return \"[Circular Reference]\";\n    }\n\n    seen.add(value);\n\n    if (Array.isArray(value)) {\n      const result = value.map((item) => deepStringify(item, maxLength, seen));\n      seen.delete(value);\n      return result;\n    }\n\n    const result: Record<string, unknown> = {};\n    for (const [key, val] of Object.entries(value)) {\n      result[key] = deepStringify(val, maxLength, seen);\n    }\n    seen.delete(value);\n    return result;\n  }\n\n  return String(value);\n}\n\nfunction truncateString(str: string, maxLength: number): string {\n  if (str.length <= maxLength) {\n    return str;\n  }\n\n  const startLength = Math.floor((maxLength - 3) / 2);\n  const endLength = maxLength - 3 - startLength;\n\n  return str.slice(0, startLength) + \"...\" + str.slice(-endLength);\n}\n```",
                "include": true
              }
            }
          },
          "include": true,
          "includeInSidebar": false,
          "isDynamicRobotsFile": false
        },
        {
          "id": "6-robots",
          "name": "6-robots",
          "displayName": " 6-ROBOTS",
          "type": "file",
          "path": "6-robots",
          "urlPath": "/6-robots",
          "content": "# ROBOTS.md\n\nThis file provides guidance to AI assistants when working with code in this repository.\n\n### Tech stack\n\n- **Next.js 15** with App Router architecture\n- **TypeScript** for type safety\n- **TailwindCSS & Shadcn** for styling\n\n<!-- section-1 -->\n\n# General rules:\n\n- Don't include any comments in any files.\n- All errors should be thrown - no \"fallback\" functionality\n- Import \"cn\" from \"@/lib/utils\" to concatenate classes.\n\n# File Organization and Naming Conventions\n\n- Types and store files alongside ancestor files\n- Actions and hooks files alongside descendent files\n\n\\`\\`\\`\n\n# Hook, action, store and type patterns\n\n<!-- section-2 -->\n\n# Console.logging\n\nAll logging should be performed using the \\`conditionalLog\\` function exported from \\`lib/log.utils.ts\\`\nThe \\`NEXT_PUBLIC_LOG_LABELS\\` variable in \\`.env.local\\` stores a comma separated string of log labels. Logs are returned if \\`NEXT_PUBLIC_LOG_LABELS=\"all\"\\`, or if \\`NEXT_PUBLIC_LOG_LABELS\\` includes the label arg in \\`conditionalLog\\`.\n\n\\`\\`\\`\n",
          "components": [],
          "sections": {
            "section1": {
              "option1": {
                "content": "- **Postgres & Prisma** for database and ORM\n- **Supabase** for authentication and real-time features\n\n# Database Architecture\n\nUse Supabase as the primary database and authentication provider.",
                "include": true
              },
              "option2": {
                "content": "- **Postgres & Prisma** for database and ORM\n- **NeonDB** for serverless Postgres\n- **Better-Auth** for authentication\n\n# Database Architecture\n\nUse NeonDB for serverless Postgres with Prisma ORM and Better-Auth for authentication.",
                "include": true
              },
              "option3": {
                "content": "- **Postgres & Prisma** for database and ORM\n- **Supabase** for real-time features\n- **NeonDB** for serverless Postgres\n- **Better-Auth** for authentication\n\n# Database Architecture\n\nUse both Supabase and NeonDB based on feature requirements. Use Better-Auth for authentication with NeonDB as the primary database.",
                "include": true
              },
              "option4": {
                "content": "# Database Architecture\n\nNo database required - this is a frontend-only application.",
                "include": true
              }
            },
            "section2": {
              "option1": {
                "content": "DB <-> Supabase Client <-> hook <-> store\n\n- Supabase client queries are called directly in react-query hooks.\n- Data returned in the onSuccess function of react-query hooks is used to update the corresponding zustand store (if applicable).\n- Loading and error state is managed via the react-query hooks, NOT the zustand store.\n- All db types should be defined from `@/integrations/supabase/types`.\n\n## Example of file patterns - [`util.md`](util.md)\n\nFollow the examples outlined in [`util.md`](util.md) when working on hook, store or type files.",
                "include": true
              },
              "option2": {
                "content": "DB <-> Action <-> hook <-> store\n\n- Better-auth client methods are called directly in react-query hooks.\n- Prisma client queries are called in actions via getAuthenticatedClient.\n- Actions are called via react-query hooks.\n- Data returned in the onSuccess function of react-query hooks is used to update the corresponding zustand store.\n- Loading and error state is managed via the react-query hooks, NOT the zustand store.\n- All db types should be defined from `\"@prisma/client\"`\n\n## Example of file patterns - [`util.md`](util.md)\n\nFollow the examples outlined in [`util.md`](util.md) when working on hook, action, store or type files. The file also contains the `prisma-rls.ts` and `action.util.ts` files for reference.",
                "include": true
              },
              "option3": {
                "content": "DB <-> Action/Supabase Client <-> hook <-> store\n\n- Better-auth client methods are called directly in react-query hooks.\n- Prisma client queries are called in actions via getAuthenticatedClient for NeonDB.\n- Supabase client queries are called directly in react-query hooks for real-time features.\n- Actions are called via react-query hooks.\n- Data returned in the onSuccess function of react-query hooks is used to update the corresponding zustand store.\n- Loading and error state is managed via the react-query hooks, NOT the zustand store.\n- Database types should be defined from `\"@prisma/client\"` for NeonDB and `@/integrations/supabase/types` for Supabase.",
                "include": true
              },
              "option4": {
                "content": "Component <-> hook <-> store\n\n- No database interactions - frontend only.\n- API calls (if any) are made directly in react-query hooks.\n- Data returned in the onSuccess function of react-query hooks is used to update the corresponding zustand store.\n- Loading and error state is managed via the react-query hooks, NOT the zustand store.\n- All types should be defined in `.types.ts` files alongside components.\n\n## Example of file patterns - [`util.md`](util.md)\n\nFollow the examples outlined in [`util.md`](util.md) when working on hook, store or type files.",
                "include": true
              }
            }
          },
          "include": true,
          "includeInSidebar": false,
          "isDynamicRobotsFile": true,
          "visibleAfterPage": "readme"
        },
        {
          "id": "7-deployment",
          "name": "7-deployment",
          "displayName": " 7-Deployment",
          "type": "file",
          "path": "7-deployment",
          "urlPath": "/7-deployment",
          "content": "# Deployment Instructions\n\nThis guide provides step-by-step instructions for deploying your application based on your selected technology stack.\n\n## Platform Setup\n\n<!-- section-1 -->\n\n## Database Deployment\n\n<!-- section-2 -->\n\n## Environment Variables\n\n<!-- section-3 -->\n\n## Authentication Setup\n\n<!-- section-4 -->\n\n## Post-Deployment Tasks\n\n<!-- section-5 -->\n",
          "components": [],
          "sections": {
            "section1": {
              "option1": {
                "content": "### Deploying to Vercel\n\n**Prerequisites:**\n- Vercel account\n- GitHub repository connected to Vercel\n\n**Steps:**\n\n1. Install Vercel CLI:\n```bash\nnpm install -g vercel\n```\n\n2. Login to Vercel:\n```bash\nvercel login\n```\n\n3. Deploy your application:\n```bash\nvercel\n```\n\n4. For production deployment:\n```bash\nvercel --prod\n```\n\n**Configuration:**\n- Vercel automatically detects Next.js projects\n- Environment variables should be set in the Vercel dashboard under Settings → Environment Variables\n- Build command: `npm run build`\n- Output directory: `.next`\n- Install command: `npm install`\n\n**Custom Domain:**\n1. Go to your project settings in Vercel dashboard\n2. Navigate to Domains\n3. Add your custom domain\n4. Update your DNS records as instructed\n\n**Continuous Deployment:**\n- Vercel automatically deploys on push to your main branch\n- Pull requests create preview deployments\n- Configure branch deployments in Settings → Git",
                "include": true
              },
              "option2": {
                "content": "### Deploying to Railway\n\n**Prerequisites:**\n- Railway account\n- GitHub repository\n\n**Steps:**\n\n1. Install Railway CLI:\n```bash\nnpm install -g @railway/cli\n```\n\n2. Login to Railway:\n```bash\nrailway login\n```\n\n3. Initialize your project:\n```bash\nrailway init\n```\n\n4. Link to your Railway project:\n```bash\nrailway link\n```\n\n5. Deploy your application:\n```bash\nrailway up\n```\n\n**Configuration:**\n\nCreate a `railway.json` file in your project root:\n```json\n{\n  \"$schema\": \"https://railway.app/railway.schema.json\",\n  \"build\": {\n    \"builder\": \"NIXPACKS\"\n  },\n  \"deploy\": {\n    \"startCommand\": \"npm start\",\n    \"restartPolicyType\": \"ON_FAILURE\",\n    \"restartPolicyMaxRetries\": 10\n  }\n}\n```\n\n**Environment Variables:**\n- Set in Railway dashboard under Variables tab\n- Or use CLI: `railway variables set KEY=value`\n\n**Health Checks:**\nRailway automatically monitors your application. Configure health check endpoint in your application:\n```typescript\napp.get('/health', (req, res) => {\n  res.status(200).json({ status: 'healthy' });\n});\n```\n\n**Custom Domain:**\n1. Go to Settings in Railway dashboard\n2. Navigate to Domains\n3. Add custom domain\n4. Update DNS records with provided values\n\n**Scaling:**\n- Railway supports horizontal and vertical scaling\n- Configure in Settings → Resources\n- Adjust memory and CPU allocation as needed",
                "include": true
              }
            },
            "section2": {
              "option1": {
                "content": "### No Database Deployment\n\nYour application is configured without a database backend. No additional database setup is required.\n\n**Static Content:**\n- All data is client-side only\n- Consider using environment variables for configuration\n- Perfect for static sites and applications without persistent data",
                "include": true
              },
              "option2": {
                "content": "### NeonDB Deployment\n\n**Prerequisites:**\n- NeonDB account (sign up at [neon.tech](https://neon.tech))\n\n**Steps:**\n\n1. Create a new project in NeonDB dashboard\n2. Copy your connection string from the dashboard\n3. Set environment variable in your deployment platform:\n   - `DATABASE_URL=your-neondb-connection-string`\n\n**Database Schema Setup:**\n\n1. Generate Prisma client:\n```bash\nnpx prisma generate\n```\n\n2. Push schema to database:\n```bash\nnpx prisma db push\n```\n\n3. Or use migrations:\n```bash\nnpx prisma migrate deploy\n```\n\n**Connection Pooling:**\nNeonDB provides built-in connection pooling. Use the pooled connection string for serverless environments.\n\n**Branching:**\nNeonDB supports database branching:\n- Create branches for preview deployments\n- Automatically create database branches per pull request\n- Configure in your CI/CD pipeline\n\n**Monitoring:**\n- Access database metrics in NeonDB dashboard\n- Set up alerts for connection limits\n- Monitor query performance",
                "include": true
              },
              "option3": {
                "content": "### Supabase Deployment\n\n**Prerequisites:**\n- Supabase account (sign up at [supabase.com](https://supabase.com))\n\n**Steps:**\n\n1. Create a new project in Supabase dashboard\n2. Note your project URL and anon key\n3. Set environment variables in your deployment platform:\n   - `VITE_SUPABASE_URL=your-project-url`\n   - `VITE_SUPABASE_ANON_KEY=your-anon-key`\n   - `DATABASE_URL=your-connection-string` (for Prisma)\n\n**Database Schema Setup:**\n\n1. Generate Prisma client:\n```bash\nnpx prisma generate\n```\n\n2. Push schema to database:\n```bash\nnpx prisma db push\n```\n\n**Row Level Security (RLS):**\nEnable RLS policies through Supabase dashboard:\n1. Navigate to Authentication → Policies\n2. Create policies for each table\n3. Test policies using the SQL editor\n\n**Storage Setup:**\nIf using Supabase Storage:\n1. Create storage buckets in dashboard\n2. Configure bucket policies\n3. Set CORS policies if needed\n\n**Realtime Setup:**\nEnable realtime for tables:\n1. Go to Database → Replication\n2. Enable replication for tables\n3. Configure realtime listeners in your application\n\n**Edge Functions (Optional):**\nDeploy edge functions for server-side logic:\n```bash\nsupabase functions deploy function-name\n```\n\n**Monitoring:**\n- Access logs in Supabase dashboard\n- Monitor API usage and database performance\n- Set up error tracking",
                "include": true
              }
            },
            "section3": {
              "option1": {
                "content": "### Core Environment Variables\n\nRequired for all deployments:\n\n```env\nNODE_ENV=production\nVITE_APP_URL=https://your-domain.com\n```",
                "include": true
              },
              "option2": {
                "content": "### Database Environment Variables\n\n**For NeonDB:**\n```env\nDATABASE_URL=postgresql://user:password@ep-xxx.us-east-2.aws.neon.tech/dbname\n```\n\n**For Supabase:**\n```env\nVITE_SUPABASE_URL=https://xxx.supabase.co\nVITE_SUPABASE_ANON_KEY=your-anon-key\nDATABASE_URL=postgresql://postgres:password@db.xxx.supabase.co:5432/postgres\n```",
                "include": true
              },
              "option3": {
                "content": "### Better Auth Environment Variables\n\n```env\nBETTER_AUTH_SECRET=your-secret-key-min-32-chars\nBETTER_AUTH_URL=https://your-domain.com\n```\n\nGenerate a secure secret:\n```bash\nopenssl rand -base64 32\n```",
                "include": true
              },
              "option4": {
                "content": "### Email Service (Resend)\n\n```env\nRESEND_API_KEY=re_xxxxxxxxxxxx\nVITE_FROM_EMAIL=noreply@yourdomain.com\n```\n\nGet your API key from [resend.com/api-keys](https://resend.com/api-keys)",
                "include": true
              },
              "option5": {
                "content": "### Stripe Payment Variables\n\n```env\nSTRIPE_SECRET_KEY=sk_live_xxxxxxxxxxxx\nVITE_STRIPE_PUBLISHABLE_KEY=pk_live_xxxxxxxxxxxx\nSTRIPE_WEBHOOK_SECRET=whsec_xxxxxxxxxxxx\n```\n\n**Setup:**\n1. Get keys from Stripe Dashboard\n2. Set up webhook endpoint at `/api/webhooks/stripe`\n3. Configure webhook events: `checkout.session.completed`, `customer.subscription.updated`, `customer.subscription.deleted`",
                "include": true
              },
              "option6": {
                "content": "### PayPal Payment Variables\n\n```env\nPAYPAL_CLIENT_ID=xxxxxxxxxxxx\nPAYPAL_CLIENT_SECRET=xxxxxxxxxxxx\nPAYPAL_MODE=live\n```\n\n**Setup:**\n1. Create app in PayPal Developer Dashboard\n2. Get credentials from app settings\n3. Use `sandbox` mode for testing, `live` for production",
                "include": true
              },
              "option7": {
                "content": "### OpenRouter AI Variables\n\n```env\nOPENROUTER_API_KEY=sk-or-xxxxxxxxxxxx\n```\n\nGet your API key from [openrouter.ai/keys](https://openrouter.ai/keys)",
                "include": true
              },
              "option8": {
                "content": "### OAuth Provider Variables (Google)\n\n```env\nGOOGLE_CLIENT_ID=xxxxxxxxxxxx.apps.googleusercontent.com\nGOOGLE_CLIENT_SECRET=xxxxxxxxxxxx\n```\n\n**Setup:**\n1. Create project in Google Cloud Console\n2. Enable Google+ API\n3. Create OAuth 2.0 credentials\n4. Add authorized redirect URI: `https://your-domain.com/api/auth/callback/google`",
                "include": true
              },
              "option9": {
                "content": "### OAuth Provider Variables (GitHub)\n\n```env\nGITHUB_CLIENT_ID=xxxxxxxxxxxx\nGITHUB_CLIENT_SECRET=xxxxxxxxxxxx\n```\n\n**Setup:**\n1. Go to GitHub Settings → Developer settings → OAuth Apps\n2. Create new OAuth App\n3. Set callback URL: `https://your-domain.com/api/auth/callback/github`",
                "include": true
              },
              "option10": {
                "content": "### OAuth Provider Variables (Apple)\n\n```env\nAPPLE_CLIENT_ID=com.yourapp.service\nAPPLE_TEAM_ID=xxxxxxxxxxxx\nAPPLE_KEY_ID=xxxxxxxxxxxx\nAPPLE_PRIVATE_KEY=\"-----BEGIN PRIVATE KEY-----\\n...\\n-----END PRIVATE KEY-----\"\n```\n\n**Setup:**\n1. Create Service ID in Apple Developer Account\n2. Configure Sign in with Apple\n3. Generate private key\n4. Set return URL: `https://your-domain.com/api/auth/callback/apple`",
                "include": true
              }
            },
            "section4": {
              "option1": {
                "content": "### Authentication Setup (Better Auth)\n\n**Database Schema:**\nBetter Auth creates necessary tables automatically on first run. Ensure your database is accessible.\n\n**Email Provider Setup:**\nConfigure Resend for email authentication:\n1. Verify your domain in Resend dashboard\n2. Add SPF and DKIM records to your DNS\n3. Test email delivery\n\n**Magic Link Setup:**\nMagic links are automatically configured if enabled. Ensure:\n- `BETTER_AUTH_URL` is set to your production domain\n- Email provider is configured correctly\n\n**Two-Factor Authentication:**\n2FA tables are created automatically. Users can enable in their account settings.\n\n**Session Management:**\n- Sessions are stored in database\n- Default expiration: 30 days\n- Refresh tokens enabled by default\n\n**Passkey Setup:**\nPasskeys require HTTPS:\n- Ensure your domain has valid SSL certificate\n- Passkeys stored securely in database\n- Works with biometric authentication",
                "include": true
              },
              "option2": {
                "content": "### Authentication Setup (Supabase Auth)\n\n**Email Templates:**\nCustomize email templates in Supabase dashboard:\n1. Navigate to Authentication → Email Templates\n2. Customize confirmation, magic link, and password reset emails\n3. Add your branding and domain\n\n**OAuth Providers:**\nConfigure in Supabase dashboard under Authentication → Providers:\n- Add client IDs and secrets\n- Set redirect URLs\n- Enable providers\n\n**Email Confirmation:**\nConfigure email confirmation settings:\n- Require email confirmation for new signups\n- Set confirmation token expiration\n- Configure redirect URLs\n\n**Password Requirements:**\nSet password policies:\n- Minimum length\n- Require special characters\n- Password history\n\n**Session Management:**\n- Sessions managed by Supabase\n- Configure JWT expiry\n- Set up refresh token rotation",
                "include": true
              },
              "option3": {
                "content": "### Organization Setup (Better Auth)\n\n**Super Admin Creation:**\nCreate your first super admin using the CLI:\n\n```bash\nnpm run create-super-admin\n```\n\nOr manually insert into database:\n```sql\nINSERT INTO users (email, role)\nVALUES ('admin@yourdomain.com', 'super_admin');\n```\n\n**Organization Creation:**\nSuper admins can create organizations through the admin panel or API.\n\n**Role Assignment:**\n- Super admins: Full system access\n- Org admins: Manage their organization and members\n- Org members: Read access to organization data\n\n**RLS Policies:**\nEnsure Row Level Security policies are enabled for organization tables:\n- Users can only see their organization data\n- Org admins can manage org members\n- Super admins have full access",
                "include": true
              }
            },
            "section5": {
              "option1": {
                "content": "### Stripe Webhook Configuration\n\n**Create Webhook Endpoint:**\n1. Go to Stripe Dashboard → Developers → Webhooks\n2. Add endpoint: `https://your-domain.com/api/webhooks/stripe`\n3. Select events to listen for:\n   - `checkout.session.completed`\n   - `customer.subscription.created`\n   - `customer.subscription.updated`\n   - `customer.subscription.deleted`\n   - `invoice.paid`\n   - `invoice.payment_failed`\n\n4. Copy the webhook signing secret\n5. Add to environment variables as `STRIPE_WEBHOOK_SECRET`\n\n**Test Webhook:**\n```bash\nstripe listen --forward-to localhost:3000/api/webhooks/stripe\n```\n\n**Webhook Handler:**\nVerify webhook signatures in your handler to ensure security.",
                "include": true
              },
              "option2": {
                "content": "### PayPal Webhook Configuration\n\n**Create Webhook:**\n1. Go to PayPal Developer Dashboard\n2. Select your app\n3. Add webhook URL: `https://your-domain.com/api/webhooks/paypal`\n4. Select events:\n   - `PAYMENT.CAPTURE.COMPLETED`\n   - `PAYMENT.CAPTURE.DENIED`\n   - `BILLING.SUBSCRIPTION.ACTIVATED`\n   - `BILLING.SUBSCRIPTION.CANCELLED`\n\n**Verify Webhooks:**\nPayPal provides webhook signature verification. Implement in your handler.",
                "include": true
              },
              "option3": {
                "content": "### Health Checks (Railway)\n\n**Configure Health Check Endpoint:**\nCreate endpoint at `/health` or `/api/health`:\n\n```typescript\nexport async function GET() {\n  return Response.json({\n    status: 'healthy',\n    timestamp: new Date().toISOString(),\n    uptime: process.uptime()\n  });\n}\n```\n\n**Railway Configuration:**\nRailway automatically detects health checks. Configure in `railway.json`:\n\n```json\n{\n  \"deploy\": {\n    \"healthcheckPath\": \"/health\",\n    \"healthcheckTimeout\": 300\n  }\n}\n```",
                "include": true
              },
              "option4": {
                "content": "### Domain and SSL Setup (Vercel)\n\n**Add Custom Domain:**\n1. Go to project settings in Vercel\n2. Navigate to Domains tab\n3. Add your domain\n\n**DNS Configuration:**\nAdd these records to your DNS provider:\n- A record: `76.76.21.21`\n- AAAA record: `2606:4700:4700::1111`\n\nOr use CNAME:\n- CNAME: `cname.vercel-dns.com`\n\n**SSL Certificate:**\n- Vercel automatically provisions SSL certificates\n- Certificates auto-renew\n- HTTPS enforced by default\n\n**Redirect www to apex:**\nConfigure in Vercel dashboard or use redirect in `vercel.json`",
                "include": true
              },
              "option5": {
                "content": "### Domain and SSL Setup (Railway)\n\n**Add Custom Domain:**\n1. Go to your project settings\n2. Click on Domains\n3. Add custom domain\n\n**DNS Configuration:**\nPoint your domain to Railway:\n- CNAME record: `your-app.up.railway.app`\n- Or use A records provided by Railway\n\n**SSL Certificate:**\n- Railway automatically provisions Let's Encrypt certificates\n- Auto-renewal enabled\n- HTTPS enforced\n\n**Domain Verification:**\nMay require TXT record verification for some domains",
                "include": true
              },
              "option6": {
                "content": "### Email Deliverability (Resend)\n\n**Domain Verification:**\n1. Add domain in Resend dashboard\n2. Add DNS records:\n   - SPF: `v=spf1 include:resend.com ~all`\n   - DKIM: Provided by Resend\n   - DMARC: `v=DMARC1; p=none;`\n\n**Verification:**\n- Verify domain in Resend dashboard\n- Test email delivery\n- Monitor bounce rates\n\n**Best Practices:**\n- Use verified domain for production\n- Set up DMARC policy to `quarantine` or `reject` after testing\n- Monitor email reputation",
                "include": true
              },
              "option7": {
                "content": "### Monitoring and Logging\n\n**Application Monitoring:**\n- Set up error tracking (Sentry, LogRocket)\n- Monitor API response times\n- Track user analytics\n\n**Database Monitoring:**\n- Monitor connection pool usage\n- Set up slow query alerts\n- Track database size and growth\n\n**Platform Monitoring:**\n- Use platform-provided metrics\n- Set up uptime monitoring\n- Configure alerts for downtime\n\n**Log Aggregation:**\nConsider log aggregation service:\n- Logtail\n- Datadog\n- New Relic",
                "include": true
              },
              "option8": {
                "content": "### File Storage Setup (Supabase)\n\n**Create Storage Buckets:**\n1. Go to Supabase dashboard → Storage\n2. Create new bucket\n3. Configure bucket as public or private\n\n**Bucket Policies:**\nSet up access policies:\n```sql\nCREATE POLICY \"Public Access\"\nON storage.objects FOR SELECT\nUSING (bucket_id = 'public-bucket');\n\nCREATE POLICY \"Authenticated Upload\"\nON storage.objects FOR INSERT\nTO authenticated\nWITH CHECK (bucket_id = 'user-uploads');\n```\n\n**CORS Configuration:**\nConfigure CORS if accessing from different domain:\n1. Go to Storage → Configuration\n2. Add allowed origins\n3. Set allowed methods\n\n**CDN:**\nSupabase Storage includes CDN. Use transformation parameters for images:\n```\nhttps://xxx.supabase.co/storage/v1/object/public/bucket/image.jpg?width=500\n```",
                "include": true
              },
              "option9": {
                "content": "### Realtime Setup (Supabase)\n\n**Enable Replication:**\n1. Go to Database → Replication\n2. Enable for tables you want realtime updates\n3. Configure publication settings\n\n**Security:**\nSet up RLS policies for realtime:\n```sql\nALTER TABLE messages ENABLE ROW LEVEL SECURITY;\n\nCREATE POLICY \"Users can see their messages\"\nON messages FOR SELECT\nUSING (auth.uid() = user_id);\n```\n\n**Client Configuration:**\nRealtime subscriptions are automatic with Supabase client. Ensure proper channel naming and filtering.\n\n**Monitoring:**\n- Monitor connection count\n- Check message delivery latency\n- Set up alerts for connection issues",
                "include": true
              },
              "option10": {
                "content": "### Post-Deployment Verification\n\n**Checklist:**\n- [ ] Application loads correctly at production URL\n- [ ] Database migrations applied successfully\n- [ ] All environment variables set correctly\n- [ ] Authentication flow works (sign up, login, logout)\n- [ ] Email delivery working\n- [ ] Payment processing functional (if applicable)\n- [ ] File uploads working (if applicable)\n- [ ] API endpoints responding correctly\n- [ ] SSL certificate valid and auto-renewing\n- [ ] Monitoring and logging configured\n- [ ] Error tracking set up\n- [ ] Backups configured\n- [ ] Domain DNS propagated\n\n**Load Testing:**\nTest your application under load:\n```bash\nnpm install -g artillery\nartillery quick --count 100 --num 10 https://your-domain.com\n```\n\n**Security Scan:**\n- Run security audit: `npm audit`\n- Check for exposed secrets\n- Verify CORS settings\n- Test rate limiting\n- Verify CSP headers",
                "include": true
              }
            }
          },
          "include": true,
          "includeInSidebar": false,
          "isDynamicRobotsFile": false
        },
        {
          "id": "code-files",
          "name": "code-files",
          "displayName": "Code files",
          "type": "directory",
          "path": "code-files",
          "urlPath": "/code-files",
          "include": true,
          "includeInSidebar": true,
          "children": []
        }
      ]
    },
    "readme": {
      "id": "readme",
      "name": "readme",
      "displayName": "README",
      "type": "file",
      "order": 1,
      "path": "readme",
      "urlPath": "/readme",
      "content": "<!-- component-READMEComponent -->\n",
      "components": [
        {
          "id": "component-READMEComponent",
          "name": "READMEComponent",
          "displayName": "READMEComponent",
          "type": "component",
          "path": "readme.component.READMEComponent",
          "urlPath": "",
          "componentId": "READMEComponent",
          "include": true
        }
      ],
      "sections": {},
      "include": true,
      "includeInSidebar": true,
      "isDynamicRobotsFile": false
    },
    "readme.component.READMEComponent": {
      "id": "component-READMEComponent",
      "name": "READMEComponent",
      "displayName": "READMEComponent",
      "type": "component",
      "path": "readme.component.READMEComponent",
      "urlPath": "",
      "componentId": "READMEComponent",
      "include": true
    },
    "theme": {
      "id": "theme",
      "name": "theme",
      "displayName": "Theme",
      "type": "file",
      "order": 2,
      "path": "theme",
      "urlPath": "/theme",
      "content": "# Theme configuration\n\nSelect and customize your theme! These styles will be applied to every component in your generated web app.\n\n<!-- component-ThemeConfiguration -->\n",
      "components": [
        {
          "id": "component-ThemeConfiguration",
          "name": "ThemeConfiguration",
          "displayName": "ThemeConfiguration",
          "type": "component",
          "path": "theme.component.ThemeConfiguration",
          "urlPath": "",
          "componentId": "ThemeConfiguration",
          "include": true
        }
      ],
      "sections": {},
      "include": true,
      "includeInSidebar": true,
      "isDynamicRobotsFile": false
    },
    "theme.component.ThemeConfiguration": {
      "id": "component-ThemeConfiguration",
      "name": "ThemeConfiguration",
      "displayName": "ThemeConfiguration",
      "type": "component",
      "path": "theme.component.ThemeConfiguration",
      "urlPath": "",
      "componentId": "ThemeConfiguration",
      "include": true
    },
    "app-directory": {
      "id": "app-directory",
      "name": "app-directory",
      "displayName": "App Directory",
      "type": "file",
      "order": 3,
      "path": "app-directory",
      "urlPath": "/app-directory",
      "content": "# App Directory\n\nThe app directory provides a site map, a UI layout heirarchy, and a data management strategy.\n\n<!-- component-LayoutAndStructure -->\n",
      "components": [
        {
          "id": "component-LayoutAndStructure",
          "name": "LayoutAndStructure",
          "displayName": "LayoutAndStructure",
          "type": "component",
          "path": "app-directory.component.LayoutAndStructure",
          "urlPath": "",
          "componentId": "LayoutAndStructure",
          "include": true
        }
      ],
      "sections": {},
      "include": true,
      "includeInSidebar": true,
      "isDynamicRobotsFile": false
    },
    "app-directory.component.LayoutAndStructure": {
      "id": "component-LayoutAndStructure",
      "name": "LayoutAndStructure",
      "displayName": "LayoutAndStructure",
      "type": "component",
      "path": "app-directory.component.LayoutAndStructure",
      "urlPath": "",
      "componentId": "LayoutAndStructure",
      "include": true
    },
    "database": {
      "id": "database",
      "name": "database",
      "displayName": "Database",
      "type": "file",
      "order": 4,
      "path": "database",
      "urlPath": "/database",
      "content": "# Database\n\n<!-- component-DatabaseConfiguration -->\n",
      "components": [
        {
          "id": "component-DatabaseConfiguration",
          "name": "DatabaseConfiguration",
          "displayName": "DatabaseConfiguration",
          "type": "component",
          "path": "database.component.DatabaseConfiguration",
          "urlPath": "",
          "componentId": "DatabaseConfiguration",
          "include": true
        }
      ],
      "sections": {},
      "include": true,
      "includeInSidebar": true,
      "isDynamicRobotsFile": false
    },
    "database.component.DatabaseConfiguration": {
      "id": "component-DatabaseConfiguration",
      "name": "DatabaseConfiguration",
      "displayName": "DatabaseConfiguration",
      "type": "component",
      "path": "database.component.DatabaseConfiguration",
      "urlPath": "",
      "componentId": "DatabaseConfiguration",
      "include": true
    },
    "environment": {
      "id": "environment",
      "name": "environment",
      "displayName": "Environment",
      "type": "file",
      "order": 5,
      "path": "environment",
      "urlPath": "/environment",
      "content": "# Environment\n\n<!-- component-NextStepsComponent -->\n",
      "components": [
        {
          "id": "component-NextStepsComponent",
          "name": "NextStepsComponent",
          "displayName": "NextStepsComponent",
          "type": "component",
          "path": "environment.component.NextStepsComponent",
          "urlPath": "",
          "componentId": "NextStepsComponent",
          "include": true
        }
      ],
      "sections": {},
      "include": true,
      "includeInSidebar": true,
      "isDynamicRobotsFile": false
    },
    "environment.component.NextStepsComponent": {
      "id": "component-NextStepsComponent",
      "name": "NextStepsComponent",
      "displayName": "NextStepsComponent",
      "type": "component",
      "path": "environment.component.NextStepsComponent",
      "urlPath": "",
      "componentId": "NextStepsComponent",
      "include": true
    },
    "extensions": {
      "id": "extensions",
      "name": "extensions",
      "displayName": "Extensions",
      "type": "file",
      "order": 6,
      "path": "extensions",
      "urlPath": "/extensions",
      "content": "# Extensions\n\n<!-- component-ExtensionsComponent -->\n",
      "components": [
        {
          "id": "component-ExtensionsComponent",
          "name": "ExtensionsComponent",
          "displayName": "ExtensionsComponent",
          "type": "component",
          "path": "extensions.component.ExtensionsComponent",
          "urlPath": "",
          "componentId": "ExtensionsComponent",
          "include": true
        }
      ],
      "sections": {},
      "include": true,
      "includeInSidebar": true,
      "isDynamicRobotsFile": false
    },
    "extensions.component.ExtensionsComponent": {
      "id": "component-ExtensionsComponent",
      "name": "ExtensionsComponent",
      "displayName": "ExtensionsComponent",
      "type": "component",
      "path": "extensions.component.ExtensionsComponent",
      "urlPath": "",
      "componentId": "ExtensionsComponent",
      "include": true
    },
    "10-util": {
      "id": "10-util",
      "name": "10-util",
      "displayName": " 10-util",
      "type": "file",
      "path": "10-util",
      "urlPath": "/10-util",
      "content": "# File examples\n\nThis guide provides code examples and patterns for organizing your application code following best practices.\n\n## Types file example\n\nType definitions establish contracts and ensure type safety throughout your application.\n\n<!-- section-1 -->\n\n## Stores file example\n\nZustand stores manage application state with persistence and middleware support.\n\n<!-- section-2 -->\n\n## Actions file example\n\nServer actions handle data mutations and communicate with your backend services.\n\n<!-- section-3 -->\n\n## Hooks file example\n\nReact Query hooks manage data fetching, caching, and synchronization.\n\n<!-- section-4 -->\n\n## Utility files\n\nUtility modules provide reusable helper functions and configurations.\n\n<!-- section-5 -->\n",
      "components": [],
      "sections": {
        "section1": {
          "option1": {
            "content": "**Types file example (Client-side):**\n\n```typescript\nexport interface AppState {\n  data: any[];\n  setData: (data: any[]) => void;\n  isLoading: boolean;\n  setIsLoading: (isLoading: boolean) => void;\n  reset: () => void;\n}\n\nexport interface ApiData {\n  id: string;\n  name: string;\n  value: number;\n}\n```",
            "include": true
          },
          "option2": {
            "content": "**Types file example (With Database):**\n\n```typescript\nimport { User } from \"@prisma/client\";\n\nexport interface AppState {\n  user: User | null;\n  setUser: (user: User | null) => void;\n  tempEmail?: string;\n  setTempEmail: (tempEmail: string) => void;\n  reset: () => void;\n}\n\nexport interface SignInData {\n  email: string;\n  password: string;\n}\n```",
            "include": true
          }
        },
        "section2": {
          "option1": {
            "content": "### Store Example (With Database)\n\n```typescript\nimport { UserRole } from \"@prisma/client\";\nimport { create } from \"zustand\";\nimport { persist } from \"zustand/middleware\";\nimport { AppState, ExtendedUser, RedirectState } from \"./layout.types\";\n\nconst initialState = {\n  user: null,\n};\n\nexport const useAppStore = create<AppState>()((set) => ({\n  ...initialState,\n  setUser: (user) => set({ user, profile: user?.profile || null }),\n  reset: () => set(initialState),\n}));\n```\n\n**Usage with React Query:**\n```typescript\nimport { useAppStore } from \"@/stores/app.stores\";\nimport { useGetUser } from \"@/hooks/user.hooks\";\n\nexport const UserProfile = () => {\n  const setUser = useAppStore((state) => state.setUser);\n  const user = useAppStore((state) => state.user);\n\n  const { isLoading } = useGetUser({\n    onSuccess: (data) => setUser(data),\n  });\n\n  if (isLoading) return <div>Loading...</div>;\n\n  return <div>Welcome, {user?.name}</div>;\n};\n```",
            "include": true
          },
          "option2": {
            "content": "### Store Example (Without Database)\n\n```typescript\nimport { create } from \"zustand\";\nimport { persist } from \"zustand/middleware\";\n\ninterface AppState {\n  theme: \"light\" | \"dark\";\n  setTheme: (theme: \"light\" | \"dark\") => void;\n  sidebarOpen: boolean;\n  toggleSidebar: () => void;\n}\n\nexport const useAppStore = create<AppState>()(\n  persist(\n    (set) => ({\n      theme: \"light\",\n      setTheme: (theme) => set({ theme }),\n      sidebarOpen: true,\n      toggleSidebar: () => set((state) => ({ sidebarOpen: !state.sidebarOpen })),\n    }),\n    {\n      name: \"app-storage\",\n    }\n  )\n);\n```\n\n**Usage:**\n```typescript\nimport { useAppStore } from \"@/stores/app.stores\";\n\nexport const ThemeToggle = () => {\n  const { theme, setTheme } = useAppStore();\n\n  return (\n    <button onClick={() => setTheme(theme === \"light\" ? \"dark\" : \"light\")}>\n      Toggle Theme\n    </button>\n  );\n};\n```",
            "include": true
          }
        },
        "section3": {
          "option1": {
            "content": "**No actions file needed for client-side only applications.**\n\nUse API routes or external API calls directly in hooks with React Query.",
            "include": true
          },
          "option2": {
            "content": "**Actions file example (NeonDB + Better Auth):**\n\n```typescript\n\"use server\";\n\nimport { ActionResponse, getActionResponse } from \"@/lib/action.utils\";\nimport { auth } from \"@/lib/auth\";\nimport { getAuthenticatedClient } from \"@/lib/auth.utils\";\nimport { User } from \"@prisma/client\";\nimport { headers } from \"next/headers\";\n\nexport const getUserAction = async (): Promise<ActionResponse<User | null>> => {\n  try {\n    const session = await auth.api.getSession({\n      headers: await headers(),\n    });\n\n    if (!session?.user) return getActionResponse();\n\n    const { db } = await getAuthenticatedClient();\n\n    const prismaUser = await db.user.findUnique({\n      where: { id: session.user.id },\n    });\n\n    return getActionResponse({ data: prismaUser });\n  } catch (error) {\n    return getActionResponse({ error });\n  }\n};\n```",
            "include": true
          },
          "option3": {
            "content": "**Actions file example (Supabase + Better Auth):**\n\n```typescript\n\"use server\";\n\nimport { ActionResponse, getActionResponse } from \"@/lib/action.utils\";\nimport { auth } from \"@/lib/auth\";\nimport { getAuthenticatedClient } from \"@/lib/auth.utils\";\nimport { User } from \"@prisma/client\";\nimport { headers } from \"next/headers\";\n\nexport const getUserAction = async (): Promise<ActionResponse<User | null>> => {\n  try {\n    const session = await auth.api.getSession({\n      headers: await headers(),\n    });\n\n    if (!session?.user) return getActionResponse();\n\n    const { db } = await getAuthenticatedClient();\n\n    const prismaUser = await db.user.findUnique({\n      where: { id: session.user.id },\n    });\n\n    return getActionResponse({ data: prismaUser });\n  } catch (error) {\n    return getActionResponse({ error });\n  }\n};\n```",
            "include": true
          },
          "option4": {
            "content": "**Actions file example (Supabase Auth Only):**\n\n```typescript\n\"use server\";\n\nimport { createClient } from \"@/lib/supabase/server\";\nimport { ActionResponse, getActionResponse } from \"@/lib/action.utils\";\n\nexport const getUserAction = async (): Promise<ActionResponse<any>> => {\n  try {\n    const supabase = await createClient();\n\n    const { data: { user }, error: authError } = await supabase.auth.getUser();\n\n    if (authError || !user) {\n      return getActionResponse({ error: authError?.message || \"Not authenticated\" });\n    }\n\n    const { data, error } = await supabase\n      .from('users')\n      .select('*')\n      .eq('id', user.id)\n      .single();\n\n    if (error) throw error;\n\n    return getActionResponse({ data });\n  } catch (error) {\n    return getActionResponse({ error });\n  }\n};\n```",
            "include": true
          }
        },
        "section4": {
          "option1": {
            "content": "**Hooks file example (Client-side):**\n\n```typescript\n\"use client\";\n\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { useRouter } from \"next/navigation\";\nimport { useAppStore } from \"../layout.stores\";\n\nexport const useGetData = () => {\n  const { setData } = useAppStore();\n\n  return useQuery({\n    queryKey: [\"data\"],\n    queryFn: async () => {\n      const response = await fetch(\"/api/data\");\n      if (!response.ok) throw new Error(\"Failed to fetch\");\n      const data = await response.json();\n      setData(data);\n      return data;\n    },\n    staleTime: 1000 * 60 * 5,\n  });\n};\n\nexport const useCreateData = () => {\n  const router = useRouter();\n\n  return useMutation({\n    mutationFn: async (newData: any) => {\n      const response = await fetch(\"/api/data\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify(newData),\n      });\n      if (!response.ok) throw new Error(\"Failed to create\");\n      return response.json();\n    },\n    onSuccess: () => {\n      router.refresh();\n    },\n  });\n};\n```",
            "include": true
          },
          "option2": {
            "content": "**Hooks file example (Better Auth):**\n\n```typescript\n\"use client\";\n\nimport { configuration, privatePaths } from \"@/configuration\";\nimport { signIn } from \"@/lib/auth-client\";\nimport { useMutation, useQuery } from \"@tanstack/react-query\";\nimport { usePathname, useRouter } from \"next/navigation\";\nimport { toast } from \"sonner\";\nimport { Toast } from \"../(components)/Toast\";\nimport { CypressDataAttributes } from \"../../types/cypress.types\";\nimport { useAppStore, useRedirectStore } from \"../layout.stores\";\nimport { SignInData } from \"../layout.types\";\nimport { getUserAction } from \"./layout.actions\";\nimport { useAuthLayoutStore } from \"./layout.stores\";\n\nexport const useGetUser = () => {\n  const { setUser, reset } = useAppStore();\n  const { reset: resetAuthLayout } = useAuthLayoutStore();\n  const { setUserData } = useRedirectStore();\n  const pathname = usePathname();\n\n  const router = useRouter();\n  return useQuery({\n    queryKey: [\"user\"],\n    queryFn: async () => {\n      const { data, error } = await getUserAction();\n      if (!data || error) {\n        if (privatePaths.includes(pathname)) {\n          router.push(configuration.paths.signIn);\n        }\n        reset();\n        resetAuthLayout();\n      }\n      if (error) throw error;\n      setUser(data ?? null);\n\n      setUserData(data);\n\n      return data;\n    },\n    staleTime: 1000 * 60 * 5,\n  });\n};\n\nexport const useSignIn = () => {\n  const { setUser, setTempEmail } = useAppStore();\n  const { setUserData } = useRedirectStore();\n  const router = useRouter();\n\n  return useMutation({\n    mutationFn: async (signInData: SignInData) => {\n      const { error } = await signIn.email({\n        email: signInData.email,\n        password: signInData.password,\n      });\n\n      if (error?.status === 403) setTempEmail(signInData.email);\n\n      if (error) throw error;\n      const { data: userData, error: userError } = await getUserAction();\n\n      if (userError) throw new Error(userError);\n\n      return userData;\n    },\n    onSuccess: (data) => {\n      if (data) {\n        setUser(data);\n        setUserData(data);\n      }\n      toast.custom(() => (\n        <Toast\n          variant=\"success\"\n          title=\"Success\"\n          message=\"Successfully signed in\"\n          data-cy={CypressDataAttributes.TOAST_SUCCESS}\n        />\n      ));\n      if (data && !data.profile?.isOnboardingComplete) {\n        router.push(configuration.paths.onboarding);\n        return;\n      }\n      router.push(configuration.paths.home);\n    },\n    onError: (\n      error: {\n        code?: string | undefined;\n        message?: string | undefined;\n        status: number;\n        statusText: string;\n      } | null\n    ) => {\n      if (error?.status === 403) return;\n      toast.custom(() => (\n        <Toast\n          variant=\"error\"\n          title=\"Sign In Failed\"\n          message={error?.message || \"Failed to sign in\"}\n          data-cy={CypressDataAttributes.TOAST_ERROR}\n        />\n      ));\n    },\n  });\n};\n```",
            "include": true
          },
          "option3": {
            "content": "**Hooks file example (Supabase Auth):**\n\n```typescript\n\"use client\";\n\nimport { createClient } from \"@/lib/supabase/client\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { useRouter } from \"next/navigation\";\nimport { useAppStore } from \"../layout.stores\";\n\nexport const useGetUser = () => {\n  const { setUser, reset } = useAppStore();\n  const router = useRouter();\n\n  return useQuery({\n    queryKey: [\"user\"],\n    queryFn: async () => {\n      const supabase = createClient();\n      const { data: { user }, error: authError } = await supabase.auth.getUser();\n\n      if (authError || !user) {\n        reset();\n        return null;\n      }\n\n      const { data, error } = await supabase\n        .from('users')\n        .select('*')\n        .eq('id', user.id)\n        .single();\n\n      if (error) throw error;\n\n      setUser(data);\n      return data;\n    },\n    staleTime: 1000 * 60 * 5,\n  });\n};\n\nexport const useSignIn = () => {\n  const { setUser } = useAppStore();\n  const router = useRouter();\n\n  return useMutation({\n    mutationFn: async ({ email, password }: { email: string; password: string }) => {\n      const supabase = createClient();\n      const { data, error } = await supabase.auth.signInWithPassword({\n        email,\n        password,\n      });\n\n      if (error) throw error;\n\n      return data.user;\n    },\n    onSuccess: (user) => {\n      setUser(user);\n      router.push('/dashboard');\n    },\n  });\n};\n```",
            "include": true
          }
        },
        "section5": {
          "option1": {
            "content": "**No utility files needed for client-side only applications.**",
            "include": true
          },
          "option2": {
            "content": "**Utility files (Better Auth + Prisma):**\n\n## `prisma-rls.ts`:\n\n```typescript\nimport { Prisma } from \"@prisma/client\";\nimport { prisma } from \"./prisma\";\n\nfunction forUser(userId: string, tenantId?: string) {\n  return Prisma.defineExtension((prisma) =>\n    prisma.$extends({\n      query: {\n        $allModels: {\n          async $allOperations({ args, query }) {\n            if (tenantId) {\n              const [, , result] = await prisma.$transaction([\n                prisma.$executeRaw`SELECT set_config('app.current_user_id', ${userId}, TRUE)`,\n                prisma.$executeRaw`SELECT set_config('app.current_tenant_id', ${tenantId}, TRUE)`,\n                query(args),\n              ]);\n              return result;\n            } else {\n              const [, result] = await prisma.$transaction([\n                prisma.$executeRaw`SELECT set_config('app.current_user_id', ${userId}, TRUE)`,\n                query(args),\n              ]);\n              return result;\n            }\n          },\n        },\n      },\n    })\n  );\n}\n\nexport function createRLSClient(userId: string, tenantId?: string) {\n  return prisma.$extends(forUser(userId, tenantId));\n}\n```\n\n## `auth.util.ts`\n\n```typescript\nimport { User } from \"better-auth\";\nimport jwt from \"jsonwebtoken\";\nimport { headers } from \"next/headers\";\nimport { auth, Session } from \"./auth\";\nimport { createRLSClient } from \"./prisma-rls\";\n\nexport async function getAuthenticatedClient(user?: User): Promise<{\n  db: ReturnType<typeof createRLSClient>;\n  session: Session | null;\n}> {\n  const headersList = await headers();\n\n  const session = await auth.api.getSession({\n    headers: headersList,\n  });\n\n  const userId = user?.id || session?.user.id;\n\n  if (!userId) {\n    throw new Error(\"Unauthorized\");\n  }\n\n  const db = createRLSClient(userId);\n\n  return { db, session };\n}\n\nexport function generateSupabaseJWT(userId: string, userRole: string): string {\n  const jwtSecret = process.env.SUPABASE_JWT_SECRET;\n\n  if (!jwtSecret) {\n    throw new Error(\"SUPABASE_JWT_SECRET is required for JWT generation\");\n  }\n\n  const payload = {\n    aud: \"authenticated\",\n    exp: Math.floor(Date.now() / 1000) + 60 * 60,\n    sub: userId,\n    email: `${userId}@better-auth.local`,\n    role: \"authenticated\",\n    user_metadata: {\n      better_auth_user_id: userId,\n      better_auth_role: userRole,\n    },\n    app_metadata: {\n      provider: \"better-auth\",\n      providers: [\"better-auth\"],\n    },\n  };\n\n  return jwt.sign(payload, jwtSecret, {\n    algorithm: \"HS256\",\n  });\n}\n```\n\n## `log.util.ts`:\n\n```typescript\nexport enum LOG_LABELS {\n  GENERATE = \"generate\",\n  API = \"api\",\n  AUTH = \"auth\",\n  DB = \"db\",\n  FETCH = \"fetch\",\n  RATE_LIMIT = \"rate-limit\",\n  IMAGE = \"image\",\n  WIDGET = \"widget\",\n}\n\ninterface ConditionalLogOptions {\n  maxStringLength?: number;\n  label: LOG_LABELS | string;\n}\n\nexport function conditionalLog(\n  data: unknown,\n  options: ConditionalLogOptions\n): string | null {\n  const { maxStringLength = 200, label } = options;\n\n  const logLabels = process.env.NEXT_PUBLIC_LOG_LABELS;\n\n  if (!logLabels || logLabels === \"none\") {\n    return null;\n  }\n\n  if (logLabels !== \"all\") {\n    const allowedLabels = logLabels.split(\",\").map((l) => l.trim());\n    if (!allowedLabels.includes(label)) {\n      return null;\n    }\n  }\n\n  try {\n    const processedData = deepStringify(data, maxStringLength, new WeakSet());\n    const result = JSON.stringify(processedData);\n    return result.replace(/\\\\s+/g, \"\");\n  } catch (error) {\n    return JSON.stringify({ error: \"Failed to stringify data\", label });\n  }\n}\n\nfunction deepStringify(\n  value: unknown,\n  maxLength: number,\n  seen: WeakSet<object>\n): unknown {\n  if (value === null || value === undefined) {\n    return value;\n  }\n\n  if (typeof value === \"string\") {\n    return truncateString(value, maxLength);\n  }\n\n  if (typeof value === \"number\" || typeof value === \"boolean\") {\n    return value;\n  }\n\n  if (value instanceof Date) {\n    return value.toISOString();\n  }\n\n  if (value instanceof Error) {\n    return {\n      name: value.name,\n      message: truncateString(value.message, maxLength),\n      stack: value.stack ? truncateString(value.stack, maxLength) : undefined,\n    };\n  }\n\n  if (typeof value === \"object\") {\n    if (seen.has(value)) {\n      return \"[Circular Reference]\";\n    }\n\n    seen.add(value);\n\n    if (Array.isArray(value)) {\n      const result = value.map((item) => deepStringify(item, maxLength, seen));\n      seen.delete(value);\n      return result;\n    }\n\n    const result: Record<string, unknown> = {};\n    for (const [key, val] of Object.entries(value)) {\n      result[key] = deepStringify(val, maxLength, seen);\n    }\n    seen.delete(value);\n    return result;\n  }\n\n  return String(value);\n}\n\nfunction truncateString(str: string, maxLength: number): string {\n  if (str.length <= maxLength) {\n    return str;\n  }\n\n  const startLength = Math.floor((maxLength - 3) / 2);\n  const endLength = maxLength - 3 - startLength;\n\n  return str.slice(0, startLength) + \"...\" + str.slice(-endLength);\n}\n```",
            "include": true
          },
          "option3": {
            "content": "**Utility files (Supabase):**\n\n## `log.util.ts`:\n\n```typescript\nexport enum LOG_LABELS {\n  GENERATE = \"generate\",\n  API = \"api\",\n  AUTH = \"auth\",\n  DB = \"db\",\n  FETCH = \"fetch\",\n  RATE_LIMIT = \"rate-limit\",\n  IMAGE = \"image\",\n  WIDGET = \"widget\",\n}\n\ninterface ConditionalLogOptions {\n  maxStringLength?: number;\n  label: LOG_LABELS | string;\n}\n\nexport function conditionalLog(\n  data: unknown,\n  options: ConditionalLogOptions\n): string | null {\n  const { maxStringLength = 200, label } = options;\n\n  const logLabels = process.env.NEXT_PUBLIC_LOG_LABELS;\n\n  if (!logLabels || logLabels === \"none\") {\n    return null;\n  }\n\n  if (logLabels !== \"all\") {\n    const allowedLabels = logLabels.split(\",\").map((l) => l.trim());\n    if (!allowedLabels.includes(label)) {\n      return null;\n    }\n  }\n\n  try {\n    const processedData = deepStringify(data, maxStringLength, new WeakSet());\n    const result = JSON.stringify(processedData);\n    return result.replace(/\\\\s+/g, \"\");\n  } catch (error) {\n    return JSON.stringify({ error: \"Failed to stringify data\", label });\n  }\n}\n\nfunction deepStringify(\n  value: unknown,\n  maxLength: number,\n  seen: WeakSet<object>\n): unknown {\n  if (value === null || value === undefined) {\n    return value;\n  }\n\n  if (typeof value === \"string\") {\n    return truncateString(value, maxLength);\n  }\n\n  if (typeof value === \"number\" || typeof value === \"boolean\") {\n    return value;\n  }\n\n  if (value instanceof Date) {\n    return value.toISOString();\n  }\n\n  if (value instanceof Error) {\n    return {\n      name: value.name,\n      message: truncateString(value.message, maxLength),\n      stack: value.stack ? truncateString(value.stack, maxLength) : undefined,\n    };\n  }\n\n  if (typeof value === \"object\") {\n    if (seen.has(value)) {\n      return \"[Circular Reference]\";\n    }\n\n    seen.add(value);\n\n    if (Array.isArray(value)) {\n      const result = value.map((item) => deepStringify(item, maxLength, seen));\n      seen.delete(value);\n      return result;\n    }\n\n    const result: Record<string, unknown> = {};\n    for (const [key, val] of Object.entries(value)) {\n      result[key] = deepStringify(val, maxLength, seen);\n    }\n    seen.delete(value);\n    return result;\n  }\n\n  return String(value);\n}\n\nfunction truncateString(str: string, maxLength: number): string {\n  if (str.length <= maxLength) {\n    return str;\n  }\n\n  const startLength = Math.floor((maxLength - 3) / 2);\n  const endLength = maxLength - 3 - startLength;\n\n  return str.slice(0, startLength) + \"...\" + str.slice(-endLength);\n}\n```",
            "include": true
          }
        }
      },
      "include": true,
      "includeInSidebar": false,
      "isDynamicRobotsFile": false
    },
    "6-robots": {
      "id": "6-robots",
      "name": "6-robots",
      "displayName": " 6-ROBOTS",
      "type": "file",
      "path": "6-robots",
      "urlPath": "/6-robots",
      "content": "# ROBOTS.md\n\nThis file provides guidance to AI assistants when working with code in this repository.\n\n### Tech stack\n\n- **Next.js 15** with App Router architecture\n- **TypeScript** for type safety\n- **TailwindCSS & Shadcn** for styling\n\n<!-- section-1 -->\n\n# General rules:\n\n- Don't include any comments in any files.\n- All errors should be thrown - no \"fallback\" functionality\n- Import \"cn\" from \"@/lib/utils\" to concatenate classes.\n\n# File Organization and Naming Conventions\n\n- Types and store files alongside ancestor files\n- Actions and hooks files alongside descendent files\n\n\\`\\`\\`\n\n# Hook, action, store and type patterns\n\n<!-- section-2 -->\n\n# Console.logging\n\nAll logging should be performed using the \\`conditionalLog\\` function exported from \\`lib/log.utils.ts\\`\nThe \\`NEXT_PUBLIC_LOG_LABELS\\` variable in \\`.env.local\\` stores a comma separated string of log labels. Logs are returned if \\`NEXT_PUBLIC_LOG_LABELS=\"all\"\\`, or if \\`NEXT_PUBLIC_LOG_LABELS\\` includes the label arg in \\`conditionalLog\\`.\n\n\\`\\`\\`\n",
      "components": [],
      "sections": {
        "section1": {
          "option1": {
            "content": "- **Postgres & Prisma** for database and ORM\n- **Supabase** for authentication and real-time features\n\n# Database Architecture\n\nUse Supabase as the primary database and authentication provider.",
            "include": true
          },
          "option2": {
            "content": "- **Postgres & Prisma** for database and ORM\n- **NeonDB** for serverless Postgres\n- **Better-Auth** for authentication\n\n# Database Architecture\n\nUse NeonDB for serverless Postgres with Prisma ORM and Better-Auth for authentication.",
            "include": true
          },
          "option3": {
            "content": "- **Postgres & Prisma** for database and ORM\n- **Supabase** for real-time features\n- **NeonDB** for serverless Postgres\n- **Better-Auth** for authentication\n\n# Database Architecture\n\nUse both Supabase and NeonDB based on feature requirements. Use Better-Auth for authentication with NeonDB as the primary database.",
            "include": true
          },
          "option4": {
            "content": "# Database Architecture\n\nNo database required - this is a frontend-only application.",
            "include": true
          }
        },
        "section2": {
          "option1": {
            "content": "DB <-> Supabase Client <-> hook <-> store\n\n- Supabase client queries are called directly in react-query hooks.\n- Data returned in the onSuccess function of react-query hooks is used to update the corresponding zustand store (if applicable).\n- Loading and error state is managed via the react-query hooks, NOT the zustand store.\n- All db types should be defined from `@/integrations/supabase/types`.\n\n## Example of file patterns - [`util.md`](util.md)\n\nFollow the examples outlined in [`util.md`](util.md) when working on hook, store or type files.",
            "include": true
          },
          "option2": {
            "content": "DB <-> Action <-> hook <-> store\n\n- Better-auth client methods are called directly in react-query hooks.\n- Prisma client queries are called in actions via getAuthenticatedClient.\n- Actions are called via react-query hooks.\n- Data returned in the onSuccess function of react-query hooks is used to update the corresponding zustand store.\n- Loading and error state is managed via the react-query hooks, NOT the zustand store.\n- All db types should be defined from `\"@prisma/client\"`\n\n## Example of file patterns - [`util.md`](util.md)\n\nFollow the examples outlined in [`util.md`](util.md) when working on hook, action, store or type files. The file also contains the `prisma-rls.ts` and `action.util.ts` files for reference.",
            "include": true
          },
          "option3": {
            "content": "DB <-> Action/Supabase Client <-> hook <-> store\n\n- Better-auth client methods are called directly in react-query hooks.\n- Prisma client queries are called in actions via getAuthenticatedClient for NeonDB.\n- Supabase client queries are called directly in react-query hooks for real-time features.\n- Actions are called via react-query hooks.\n- Data returned in the onSuccess function of react-query hooks is used to update the corresponding zustand store.\n- Loading and error state is managed via the react-query hooks, NOT the zustand store.\n- Database types should be defined from `\"@prisma/client\"` for NeonDB and `@/integrations/supabase/types` for Supabase.",
            "include": true
          },
          "option4": {
            "content": "Component <-> hook <-> store\n\n- No database interactions - frontend only.\n- API calls (if any) are made directly in react-query hooks.\n- Data returned in the onSuccess function of react-query hooks is used to update the corresponding zustand store.\n- Loading and error state is managed via the react-query hooks, NOT the zustand store.\n- All types should be defined in `.types.ts` files alongside components.\n\n## Example of file patterns - [`util.md`](util.md)\n\nFollow the examples outlined in [`util.md`](util.md) when working on hook, store or type files.",
            "include": true
          }
        }
      },
      "include": true,
      "includeInSidebar": false,
      "isDynamicRobotsFile": true,
      "visibleAfterPage": "readme"
    },
    "7-deployment": {
      "id": "7-deployment",
      "name": "7-deployment",
      "displayName": " 7-Deployment",
      "type": "file",
      "path": "7-deployment",
      "urlPath": "/7-deployment",
      "content": "# Deployment Instructions\n\nThis guide provides step-by-step instructions for deploying your application based on your selected technology stack.\n\n## Platform Setup\n\n<!-- section-1 -->\n\n## Database Deployment\n\n<!-- section-2 -->\n\n## Environment Variables\n\n<!-- section-3 -->\n\n## Authentication Setup\n\n<!-- section-4 -->\n\n## Post-Deployment Tasks\n\n<!-- section-5 -->\n",
      "components": [],
      "sections": {
        "section1": {
          "option1": {
            "content": "### Deploying to Vercel\n\n**Prerequisites:**\n- Vercel account\n- GitHub repository connected to Vercel\n\n**Steps:**\n\n1. Install Vercel CLI:\n```bash\nnpm install -g vercel\n```\n\n2. Login to Vercel:\n```bash\nvercel login\n```\n\n3. Deploy your application:\n```bash\nvercel\n```\n\n4. For production deployment:\n```bash\nvercel --prod\n```\n\n**Configuration:**\n- Vercel automatically detects Next.js projects\n- Environment variables should be set in the Vercel dashboard under Settings → Environment Variables\n- Build command: `npm run build`\n- Output directory: `.next`\n- Install command: `npm install`\n\n**Custom Domain:**\n1. Go to your project settings in Vercel dashboard\n2. Navigate to Domains\n3. Add your custom domain\n4. Update your DNS records as instructed\n\n**Continuous Deployment:**\n- Vercel automatically deploys on push to your main branch\n- Pull requests create preview deployments\n- Configure branch deployments in Settings → Git",
            "include": true
          },
          "option2": {
            "content": "### Deploying to Railway\n\n**Prerequisites:**\n- Railway account\n- GitHub repository\n\n**Steps:**\n\n1. Install Railway CLI:\n```bash\nnpm install -g @railway/cli\n```\n\n2. Login to Railway:\n```bash\nrailway login\n```\n\n3. Initialize your project:\n```bash\nrailway init\n```\n\n4. Link to your Railway project:\n```bash\nrailway link\n```\n\n5. Deploy your application:\n```bash\nrailway up\n```\n\n**Configuration:**\n\nCreate a `railway.json` file in your project root:\n```json\n{\n  \"$schema\": \"https://railway.app/railway.schema.json\",\n  \"build\": {\n    \"builder\": \"NIXPACKS\"\n  },\n  \"deploy\": {\n    \"startCommand\": \"npm start\",\n    \"restartPolicyType\": \"ON_FAILURE\",\n    \"restartPolicyMaxRetries\": 10\n  }\n}\n```\n\n**Environment Variables:**\n- Set in Railway dashboard under Variables tab\n- Or use CLI: `railway variables set KEY=value`\n\n**Health Checks:**\nRailway automatically monitors your application. Configure health check endpoint in your application:\n```typescript\napp.get('/health', (req, res) => {\n  res.status(200).json({ status: 'healthy' });\n});\n```\n\n**Custom Domain:**\n1. Go to Settings in Railway dashboard\n2. Navigate to Domains\n3. Add custom domain\n4. Update DNS records with provided values\n\n**Scaling:**\n- Railway supports horizontal and vertical scaling\n- Configure in Settings → Resources\n- Adjust memory and CPU allocation as needed",
            "include": true
          }
        },
        "section2": {
          "option1": {
            "content": "### No Database Deployment\n\nYour application is configured without a database backend. No additional database setup is required.\n\n**Static Content:**\n- All data is client-side only\n- Consider using environment variables for configuration\n- Perfect for static sites and applications without persistent data",
            "include": true
          },
          "option2": {
            "content": "### NeonDB Deployment\n\n**Prerequisites:**\n- NeonDB account (sign up at [neon.tech](https://neon.tech))\n\n**Steps:**\n\n1. Create a new project in NeonDB dashboard\n2. Copy your connection string from the dashboard\n3. Set environment variable in your deployment platform:\n   - `DATABASE_URL=your-neondb-connection-string`\n\n**Database Schema Setup:**\n\n1. Generate Prisma client:\n```bash\nnpx prisma generate\n```\n\n2. Push schema to database:\n```bash\nnpx prisma db push\n```\n\n3. Or use migrations:\n```bash\nnpx prisma migrate deploy\n```\n\n**Connection Pooling:**\nNeonDB provides built-in connection pooling. Use the pooled connection string for serverless environments.\n\n**Branching:**\nNeonDB supports database branching:\n- Create branches for preview deployments\n- Automatically create database branches per pull request\n- Configure in your CI/CD pipeline\n\n**Monitoring:**\n- Access database metrics in NeonDB dashboard\n- Set up alerts for connection limits\n- Monitor query performance",
            "include": true
          },
          "option3": {
            "content": "### Supabase Deployment\n\n**Prerequisites:**\n- Supabase account (sign up at [supabase.com](https://supabase.com))\n\n**Steps:**\n\n1. Create a new project in Supabase dashboard\n2. Note your project URL and anon key\n3. Set environment variables in your deployment platform:\n   - `VITE_SUPABASE_URL=your-project-url`\n   - `VITE_SUPABASE_ANON_KEY=your-anon-key`\n   - `DATABASE_URL=your-connection-string` (for Prisma)\n\n**Database Schema Setup:**\n\n1. Generate Prisma client:\n```bash\nnpx prisma generate\n```\n\n2. Push schema to database:\n```bash\nnpx prisma db push\n```\n\n**Row Level Security (RLS):**\nEnable RLS policies through Supabase dashboard:\n1. Navigate to Authentication → Policies\n2. Create policies for each table\n3. Test policies using the SQL editor\n\n**Storage Setup:**\nIf using Supabase Storage:\n1. Create storage buckets in dashboard\n2. Configure bucket policies\n3. Set CORS policies if needed\n\n**Realtime Setup:**\nEnable realtime for tables:\n1. Go to Database → Replication\n2. Enable replication for tables\n3. Configure realtime listeners in your application\n\n**Edge Functions (Optional):**\nDeploy edge functions for server-side logic:\n```bash\nsupabase functions deploy function-name\n```\n\n**Monitoring:**\n- Access logs in Supabase dashboard\n- Monitor API usage and database performance\n- Set up error tracking",
            "include": true
          }
        },
        "section3": {
          "option1": {
            "content": "### Core Environment Variables\n\nRequired for all deployments:\n\n```env\nNODE_ENV=production\nVITE_APP_URL=https://your-domain.com\n```",
            "include": true
          },
          "option2": {
            "content": "### Database Environment Variables\n\n**For NeonDB:**\n```env\nDATABASE_URL=postgresql://user:password@ep-xxx.us-east-2.aws.neon.tech/dbname\n```\n\n**For Supabase:**\n```env\nVITE_SUPABASE_URL=https://xxx.supabase.co\nVITE_SUPABASE_ANON_KEY=your-anon-key\nDATABASE_URL=postgresql://postgres:password@db.xxx.supabase.co:5432/postgres\n```",
            "include": true
          },
          "option3": {
            "content": "### Better Auth Environment Variables\n\n```env\nBETTER_AUTH_SECRET=your-secret-key-min-32-chars\nBETTER_AUTH_URL=https://your-domain.com\n```\n\nGenerate a secure secret:\n```bash\nopenssl rand -base64 32\n```",
            "include": true
          },
          "option4": {
            "content": "### Email Service (Resend)\n\n```env\nRESEND_API_KEY=re_xxxxxxxxxxxx\nVITE_FROM_EMAIL=noreply@yourdomain.com\n```\n\nGet your API key from [resend.com/api-keys](https://resend.com/api-keys)",
            "include": true
          },
          "option5": {
            "content": "### Stripe Payment Variables\n\n```env\nSTRIPE_SECRET_KEY=sk_live_xxxxxxxxxxxx\nVITE_STRIPE_PUBLISHABLE_KEY=pk_live_xxxxxxxxxxxx\nSTRIPE_WEBHOOK_SECRET=whsec_xxxxxxxxxxxx\n```\n\n**Setup:**\n1. Get keys from Stripe Dashboard\n2. Set up webhook endpoint at `/api/webhooks/stripe`\n3. Configure webhook events: `checkout.session.completed`, `customer.subscription.updated`, `customer.subscription.deleted`",
            "include": true
          },
          "option6": {
            "content": "### PayPal Payment Variables\n\n```env\nPAYPAL_CLIENT_ID=xxxxxxxxxxxx\nPAYPAL_CLIENT_SECRET=xxxxxxxxxxxx\nPAYPAL_MODE=live\n```\n\n**Setup:**\n1. Create app in PayPal Developer Dashboard\n2. Get credentials from app settings\n3. Use `sandbox` mode for testing, `live` for production",
            "include": true
          },
          "option7": {
            "content": "### OpenRouter AI Variables\n\n```env\nOPENROUTER_API_KEY=sk-or-xxxxxxxxxxxx\n```\n\nGet your API key from [openrouter.ai/keys](https://openrouter.ai/keys)",
            "include": true
          },
          "option8": {
            "content": "### OAuth Provider Variables (Google)\n\n```env\nGOOGLE_CLIENT_ID=xxxxxxxxxxxx.apps.googleusercontent.com\nGOOGLE_CLIENT_SECRET=xxxxxxxxxxxx\n```\n\n**Setup:**\n1. Create project in Google Cloud Console\n2. Enable Google+ API\n3. Create OAuth 2.0 credentials\n4. Add authorized redirect URI: `https://your-domain.com/api/auth/callback/google`",
            "include": true
          },
          "option9": {
            "content": "### OAuth Provider Variables (GitHub)\n\n```env\nGITHUB_CLIENT_ID=xxxxxxxxxxxx\nGITHUB_CLIENT_SECRET=xxxxxxxxxxxx\n```\n\n**Setup:**\n1. Go to GitHub Settings → Developer settings → OAuth Apps\n2. Create new OAuth App\n3. Set callback URL: `https://your-domain.com/api/auth/callback/github`",
            "include": true
          },
          "option10": {
            "content": "### OAuth Provider Variables (Apple)\n\n```env\nAPPLE_CLIENT_ID=com.yourapp.service\nAPPLE_TEAM_ID=xxxxxxxxxxxx\nAPPLE_KEY_ID=xxxxxxxxxxxx\nAPPLE_PRIVATE_KEY=\"-----BEGIN PRIVATE KEY-----\\n...\\n-----END PRIVATE KEY-----\"\n```\n\n**Setup:**\n1. Create Service ID in Apple Developer Account\n2. Configure Sign in with Apple\n3. Generate private key\n4. Set return URL: `https://your-domain.com/api/auth/callback/apple`",
            "include": true
          }
        },
        "section4": {
          "option1": {
            "content": "### Authentication Setup (Better Auth)\n\n**Database Schema:**\nBetter Auth creates necessary tables automatically on first run. Ensure your database is accessible.\n\n**Email Provider Setup:**\nConfigure Resend for email authentication:\n1. Verify your domain in Resend dashboard\n2. Add SPF and DKIM records to your DNS\n3. Test email delivery\n\n**Magic Link Setup:**\nMagic links are automatically configured if enabled. Ensure:\n- `BETTER_AUTH_URL` is set to your production domain\n- Email provider is configured correctly\n\n**Two-Factor Authentication:**\n2FA tables are created automatically. Users can enable in their account settings.\n\n**Session Management:**\n- Sessions are stored in database\n- Default expiration: 30 days\n- Refresh tokens enabled by default\n\n**Passkey Setup:**\nPasskeys require HTTPS:\n- Ensure your domain has valid SSL certificate\n- Passkeys stored securely in database\n- Works with biometric authentication",
            "include": true
          },
          "option2": {
            "content": "### Authentication Setup (Supabase Auth)\n\n**Email Templates:**\nCustomize email templates in Supabase dashboard:\n1. Navigate to Authentication → Email Templates\n2. Customize confirmation, magic link, and password reset emails\n3. Add your branding and domain\n\n**OAuth Providers:**\nConfigure in Supabase dashboard under Authentication → Providers:\n- Add client IDs and secrets\n- Set redirect URLs\n- Enable providers\n\n**Email Confirmation:**\nConfigure email confirmation settings:\n- Require email confirmation for new signups\n- Set confirmation token expiration\n- Configure redirect URLs\n\n**Password Requirements:**\nSet password policies:\n- Minimum length\n- Require special characters\n- Password history\n\n**Session Management:**\n- Sessions managed by Supabase\n- Configure JWT expiry\n- Set up refresh token rotation",
            "include": true
          },
          "option3": {
            "content": "### Organization Setup (Better Auth)\n\n**Super Admin Creation:**\nCreate your first super admin using the CLI:\n\n```bash\nnpm run create-super-admin\n```\n\nOr manually insert into database:\n```sql\nINSERT INTO users (email, role)\nVALUES ('admin@yourdomain.com', 'super_admin');\n```\n\n**Organization Creation:**\nSuper admins can create organizations through the admin panel or API.\n\n**Role Assignment:**\n- Super admins: Full system access\n- Org admins: Manage their organization and members\n- Org members: Read access to organization data\n\n**RLS Policies:**\nEnsure Row Level Security policies are enabled for organization tables:\n- Users can only see their organization data\n- Org admins can manage org members\n- Super admins have full access",
            "include": true
          }
        },
        "section5": {
          "option1": {
            "content": "### Stripe Webhook Configuration\n\n**Create Webhook Endpoint:**\n1. Go to Stripe Dashboard → Developers → Webhooks\n2. Add endpoint: `https://your-domain.com/api/webhooks/stripe`\n3. Select events to listen for:\n   - `checkout.session.completed`\n   - `customer.subscription.created`\n   - `customer.subscription.updated`\n   - `customer.subscription.deleted`\n   - `invoice.paid`\n   - `invoice.payment_failed`\n\n4. Copy the webhook signing secret\n5. Add to environment variables as `STRIPE_WEBHOOK_SECRET`\n\n**Test Webhook:**\n```bash\nstripe listen --forward-to localhost:3000/api/webhooks/stripe\n```\n\n**Webhook Handler:**\nVerify webhook signatures in your handler to ensure security.",
            "include": true
          },
          "option2": {
            "content": "### PayPal Webhook Configuration\n\n**Create Webhook:**\n1. Go to PayPal Developer Dashboard\n2. Select your app\n3. Add webhook URL: `https://your-domain.com/api/webhooks/paypal`\n4. Select events:\n   - `PAYMENT.CAPTURE.COMPLETED`\n   - `PAYMENT.CAPTURE.DENIED`\n   - `BILLING.SUBSCRIPTION.ACTIVATED`\n   - `BILLING.SUBSCRIPTION.CANCELLED`\n\n**Verify Webhooks:**\nPayPal provides webhook signature verification. Implement in your handler.",
            "include": true
          },
          "option3": {
            "content": "### Health Checks (Railway)\n\n**Configure Health Check Endpoint:**\nCreate endpoint at `/health` or `/api/health`:\n\n```typescript\nexport async function GET() {\n  return Response.json({\n    status: 'healthy',\n    timestamp: new Date().toISOString(),\n    uptime: process.uptime()\n  });\n}\n```\n\n**Railway Configuration:**\nRailway automatically detects health checks. Configure in `railway.json`:\n\n```json\n{\n  \"deploy\": {\n    \"healthcheckPath\": \"/health\",\n    \"healthcheckTimeout\": 300\n  }\n}\n```",
            "include": true
          },
          "option4": {
            "content": "### Domain and SSL Setup (Vercel)\n\n**Add Custom Domain:**\n1. Go to project settings in Vercel\n2. Navigate to Domains tab\n3. Add your domain\n\n**DNS Configuration:**\nAdd these records to your DNS provider:\n- A record: `76.76.21.21`\n- AAAA record: `2606:4700:4700::1111`\n\nOr use CNAME:\n- CNAME: `cname.vercel-dns.com`\n\n**SSL Certificate:**\n- Vercel automatically provisions SSL certificates\n- Certificates auto-renew\n- HTTPS enforced by default\n\n**Redirect www to apex:**\nConfigure in Vercel dashboard or use redirect in `vercel.json`",
            "include": true
          },
          "option5": {
            "content": "### Domain and SSL Setup (Railway)\n\n**Add Custom Domain:**\n1. Go to your project settings\n2. Click on Domains\n3. Add custom domain\n\n**DNS Configuration:**\nPoint your domain to Railway:\n- CNAME record: `your-app.up.railway.app`\n- Or use A records provided by Railway\n\n**SSL Certificate:**\n- Railway automatically provisions Let's Encrypt certificates\n- Auto-renewal enabled\n- HTTPS enforced\n\n**Domain Verification:**\nMay require TXT record verification for some domains",
            "include": true
          },
          "option6": {
            "content": "### Email Deliverability (Resend)\n\n**Domain Verification:**\n1. Add domain in Resend dashboard\n2. Add DNS records:\n   - SPF: `v=spf1 include:resend.com ~all`\n   - DKIM: Provided by Resend\n   - DMARC: `v=DMARC1; p=none;`\n\n**Verification:**\n- Verify domain in Resend dashboard\n- Test email delivery\n- Monitor bounce rates\n\n**Best Practices:**\n- Use verified domain for production\n- Set up DMARC policy to `quarantine` or `reject` after testing\n- Monitor email reputation",
            "include": true
          },
          "option7": {
            "content": "### Monitoring and Logging\n\n**Application Monitoring:**\n- Set up error tracking (Sentry, LogRocket)\n- Monitor API response times\n- Track user analytics\n\n**Database Monitoring:**\n- Monitor connection pool usage\n- Set up slow query alerts\n- Track database size and growth\n\n**Platform Monitoring:**\n- Use platform-provided metrics\n- Set up uptime monitoring\n- Configure alerts for downtime\n\n**Log Aggregation:**\nConsider log aggregation service:\n- Logtail\n- Datadog\n- New Relic",
            "include": true
          },
          "option8": {
            "content": "### File Storage Setup (Supabase)\n\n**Create Storage Buckets:**\n1. Go to Supabase dashboard → Storage\n2. Create new bucket\n3. Configure bucket as public or private\n\n**Bucket Policies:**\nSet up access policies:\n```sql\nCREATE POLICY \"Public Access\"\nON storage.objects FOR SELECT\nUSING (bucket_id = 'public-bucket');\n\nCREATE POLICY \"Authenticated Upload\"\nON storage.objects FOR INSERT\nTO authenticated\nWITH CHECK (bucket_id = 'user-uploads');\n```\n\n**CORS Configuration:**\nConfigure CORS if accessing from different domain:\n1. Go to Storage → Configuration\n2. Add allowed origins\n3. Set allowed methods\n\n**CDN:**\nSupabase Storage includes CDN. Use transformation parameters for images:\n```\nhttps://xxx.supabase.co/storage/v1/object/public/bucket/image.jpg?width=500\n```",
            "include": true
          },
          "option9": {
            "content": "### Realtime Setup (Supabase)\n\n**Enable Replication:**\n1. Go to Database → Replication\n2. Enable for tables you want realtime updates\n3. Configure publication settings\n\n**Security:**\nSet up RLS policies for realtime:\n```sql\nALTER TABLE messages ENABLE ROW LEVEL SECURITY;\n\nCREATE POLICY \"Users can see their messages\"\nON messages FOR SELECT\nUSING (auth.uid() = user_id);\n```\n\n**Client Configuration:**\nRealtime subscriptions are automatic with Supabase client. Ensure proper channel naming and filtering.\n\n**Monitoring:**\n- Monitor connection count\n- Check message delivery latency\n- Set up alerts for connection issues",
            "include": true
          },
          "option10": {
            "content": "### Post-Deployment Verification\n\n**Checklist:**\n- [ ] Application loads correctly at production URL\n- [ ] Database migrations applied successfully\n- [ ] All environment variables set correctly\n- [ ] Authentication flow works (sign up, login, logout)\n- [ ] Email delivery working\n- [ ] Payment processing functional (if applicable)\n- [ ] File uploads working (if applicable)\n- [ ] API endpoints responding correctly\n- [ ] SSL certificate valid and auto-renewing\n- [ ] Monitoring and logging configured\n- [ ] Error tracking set up\n- [ ] Backups configured\n- [ ] Domain DNS propagated\n\n**Load Testing:**\nTest your application under load:\n```bash\nnpm install -g artillery\nartillery quick --count 100 --num 10 https://your-domain.com\n```\n\n**Security Scan:**\n- Run security audit: `npm audit`\n- Check for exposed secrets\n- Verify CORS settings\n- Test rate limiting\n- Verify CSP headers",
            "include": true
          }
        }
      },
      "include": true,
      "includeInSidebar": false,
      "isDynamicRobotsFile": false
    },
    "code-files": {
      "id": "code-files",
      "name": "code-files",
      "displayName": "Code files",
      "type": "directory",
      "path": "code-files",
      "urlPath": "/code-files",
      "include": true,
      "includeInSidebar": true,
      "children": []
    }
  },
  "contentVersion": 58
}